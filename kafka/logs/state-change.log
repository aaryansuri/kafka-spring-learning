[2023-02-02 11:44:52,922] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 11:45:32,183] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-02 11:45:32,254] INFO [Controller id=0 epoch=6] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-02 11:45:32,265] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set(0) for 54 partitions (state.change.logger)
[2023-02-02 11:45:32,335] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 11:45:32,388] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 6 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-02 11:45:32,411] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,430] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,433] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,436] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 0 from offset 2 with partition epoch 0, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,437] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 15 with partition epoch 0, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,438] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,441] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,444] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,449] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,452] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,455] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,458] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 0 from offset 1 with partition epoch 0, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,458] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,462] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 1101 with partition epoch 0, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,463] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,467] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,470] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,473] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 0 from offset 139 with partition epoch 0, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,474] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,479] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,483] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,487] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,490] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,494] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,498] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 152 with partition epoch 0, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,498] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,501] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,504] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,509] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,512] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,515] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,519] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,521] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,524] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,528] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 0 from offset 3 with partition epoch 0, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,529] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,532] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,535] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,539] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,542] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,545] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,548] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,551] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,555] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,558] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,562] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 199 with partition epoch 0, high watermark 199, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,562] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,565] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,568] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,572] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,576] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,580] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,583] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,586] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 11:45:32,634] INFO [Broker id=0] Finished LeaderAndIsr request in 302ms correlationId 1 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 11:45:32,649] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 2 (state.change.logger)
[2023-02-02 13:08:17,544] INFO [Controller id=0 epoch=6] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 13:08:40,975] INFO [Controller id=3 epoch=7] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-02 13:08:41,095] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,099] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,100] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,100] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,100] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,100] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,100] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,100] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,101] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,101] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,101] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,101] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,101] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,102] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,102] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,102] INFO [Controller id=3 epoch=7] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,102] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,102] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,103] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,103] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,103] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,103] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,103] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,104] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,105] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,106] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,107] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,108] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,108] INFO [Controller id=3 epoch=7] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-02 13:08:41,110] INFO [Controller id=3 epoch=7] Sending UpdateMetadata request to brokers Set(3) for 54 partitions (state.change.logger)
[2023-02-02 13:08:41,151] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,154] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,154] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,154] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,154] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,155] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,155] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,155] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,155] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,156] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,156] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,156] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,156] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,156] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,157] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,157] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,157] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,157] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,157] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,157] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,158] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,158] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,159] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,159] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,159] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,159] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,159] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,160] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,160] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,160] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,160] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,160] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,160] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,161] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,161] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,161] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,161] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,162] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,162] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,162] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,162] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,163] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,163] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,163] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,163] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,164] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,164] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,164] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,165] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,165] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,165] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,165] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,166] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,166] ERROR [Controller id=3 epoch=7] Controller 3 epoch 7 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-02 13:08:41,167] INFO [Controller id=3 epoch=7] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 13:13:04,346] INFO [Controller id=0 epoch=8] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-02 13:13:04,403] INFO [Controller id=0 epoch=8] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 54 become-follower partitions (state.change.logger)
[2023-02-02 13:13:04,409] INFO [Controller id=0 epoch=8] Sending UpdateMetadata request to brokers Set(0) for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,525] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,599] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,599] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,599] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,599] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,599] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,600] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,601] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,602] INFO [Controller id=0 epoch=8] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2023-02-02 13:13:04,603] INFO [Controller id=0 epoch=8] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-02 13:13:04,603] INFO [Controller id=0 epoch=8] Sending UpdateMetadata request to brokers Set(0) for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,627] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-0 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,641] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-29 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,641] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-48 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,642] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition test-topic-2 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,642] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-10 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,642] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-45 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,643] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-26 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,643] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-7 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,643] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-42 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,644] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-4 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,644] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-23 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,644] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition test-topic-3 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,644] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-1 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,645] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-20 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,645] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-39 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,645] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-17 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,645] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-36 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,646] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition test-topic-0 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,646] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-14 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,646] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-33 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,647] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-49 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,647] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-11 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,647] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-30 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,647] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-46 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,648] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-27 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,648] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-8 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,648] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-24 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,648] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-43 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,649] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-5 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,649] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-21 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,649] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-40 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,649] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-2 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,650] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-37 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,650] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-18 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,650] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition test-topic-1 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,650] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-34 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,651] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-15 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,651] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-12 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,651] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-31 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,651] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-9 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,652] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-47 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,652] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-19 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,652] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-28 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,652] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-38 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,653] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-35 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,653] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-6 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,653] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-44 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,654] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-25 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,654] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-16 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,654] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-22 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,654] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-41 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,655] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-32 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,655] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-3 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,655] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 8 for partition __consumer_offsets-13 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-02 13:13:04,658] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 1 for 0 partitions (state.change.logger)
[2023-02-02 13:13:04,676] INFO [Broker id=0] Finished LeaderAndIsr request in 152ms correlationId 1 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,686] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2023-02-02 13:13:04,688] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,692] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 8 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,698] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,703] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,706] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,710] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 2 with partition epoch 2, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,712] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 15 with partition epoch 2, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,715] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,718] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,720] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,724] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,726] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,729] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,730] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 1 with partition epoch 2, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,733] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,736] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 1101 with partition epoch 2, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,739] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,741] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,744] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,746] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 139 with partition epoch 2, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,748] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,751] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,753] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,755] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,758] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,761] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,769] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 152 with partition epoch 2, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,771] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,773] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,775] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,777] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,779] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,781] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,783] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,785] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,787] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,789] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 3 with partition epoch 2, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,790] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,792] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,794] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,796] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,797] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,799] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,801] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,803] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,804] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,806] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,808] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 199 with partition epoch 2, high watermark 199, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,809] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,811] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,813] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,815] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,817] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,819] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,821] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,822] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:04,848] INFO [Broker id=0] Finished LeaderAndIsr request in 160ms correlationId 3 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 13:13:04,852] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2023-02-02 13:13:05,642] INFO [Controller id=0 epoch=8] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 13:13:15,079] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-02 13:13:15,136] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-02 13:13:15,139] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 54 partitions (state.change.logger)
[2023-02-02 13:13:15,218] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 13:13:15,271] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 9 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-02 13:13:15,290] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,307] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,310] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,312] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 2 with partition epoch 2, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,316] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 15 with partition epoch 2, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,318] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,321] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,324] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,327] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,330] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,334] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,336] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 1 with partition epoch 2, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,340] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,343] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 1101 with partition epoch 2, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,347] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,350] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,353] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,356] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 139 with partition epoch 2, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,359] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,362] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,366] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,369] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,372] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,375] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,378] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 152 with partition epoch 2, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,381] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,384] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,387] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,390] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,393] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,396] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,399] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,402] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,405] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,409] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 3 with partition epoch 2, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,413] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,415] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,418] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,421] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,424] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,427] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,430] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,433] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,436] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,439] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,443] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 199 with partition epoch 2, high watermark 199, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,446] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,448] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,451] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,454] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,457] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,461] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,463] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,466] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:13:15,508] INFO [Broker id=0] Finished LeaderAndIsr request in 292ms correlationId 1 from controller 0 for 54 partitions (state.change.logger)
[2023-02-02 13:13:15,541] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2023-02-02 13:13:21,296] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-02 13:13:21,299] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(1) for 54 partitions (state.change.logger)
[2023-02-02 13:13:21,590] INFO [Broker id=1] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2023-02-02 13:13:33,840] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2023-02-02 13:13:33,844] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(3) for 54 partitions (state.change.logger)
[2023-02-02 13:13:34,130] INFO [Broker id=3] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2023-02-02 13:46:21,409] INFO [Controller id=0 epoch=9] Changed partition library-events-2 state from NonExistentPartition to NewPartition with assigned replicas 0,3,1 (state.change.logger)
[2023-02-02 13:46:21,409] INFO [Controller id=0 epoch=9] Changed partition library-events-1 state from NonExistentPartition to NewPartition with assigned replicas 1,0,3 (state.change.logger)
[2023-02-02 13:46:21,409] INFO [Controller id=0 epoch=9] Changed partition library-events-0 state from NonExistentPartition to NewPartition with assigned replicas 3,1,0 (state.change.logger)
[2023-02-02 13:46:21,409] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 13:46:21,409] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Changed partition library-events-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 3, 1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Changed partition library-events-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 0, 3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Changed partition library-events-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 1, 0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,424] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-02 13:46:21,440] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,440] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 9 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-02 13:46:21,440] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 2 from controller 0 for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,456] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,471] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0,3,1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,502] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 3. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,502] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 9 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-02 13:46:21,518] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 9 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-02 13:46:21,518] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,518] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 5 for 2 partitions (state.change.logger)
[2023-02-02 13:46:21,596] INFO [Broker id=0] Finished LeaderAndIsr request in 156ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,596] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2023-02-02 13:46:21,690] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1,0,3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,706] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3,1,0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,768] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,768] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,784] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,784] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 1 for 2 partitions (state.change.logger)
[2023-02-02 13:46:21,784] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 3. Previous leader epoch was -1. (state.change.logger)
[2023-02-02 13:46:21,784] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 2 for 2 partitions (state.change.logger)
[2023-02-02 13:46:21,862] INFO [Broker id=1] Finished LeaderAndIsr request in 422ms correlationId 2 from controller 0 for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,877] INFO [Broker id=3] Finished LeaderAndIsr request in 437ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-02 13:46:21,877] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2023-02-02 13:46:21,877] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2023-02-04 14:06:24,252] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-04 14:06:24,267] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 55 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-04 14:06:24,267] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-04 14:06:24,537] INFO [Controller id=0 epoch=10] Partition library-events-1 state changed to (Leader:-1,ISR:0,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 14:06:24,537] INFO [Controller id=0 epoch=10] Partition library-events-0 state changed to (Leader:3,ISR:3,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 14:06:24,550] INFO [Controller id=0 epoch=10] Partition library-events-2 state changed to (Leader:0,ISR:0,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 14:06:24,565] INFO [Controller id=0 epoch=10] Partition library-events-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 14:06:24,565] INFO [Controller id=0 epoch=10] Partition library-events-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 14:06:24,565] INFO [Controller id=0 epoch=10] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 14:06:24,565] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-04 14:06:24,565] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-04 14:06:24,722] INFO [Controller id=0 epoch=10] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=3, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=3) (state.change.logger)
[2023-02-04 14:06:24,722] INFO [Controller id=0 epoch=10] Changed partition library-events-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=3, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=3) (state.change.logger)
[2023-02-04 14:06:24,722] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-04 14:06:24,722] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 2 partitions (state.change.logger)
[2023-02-04 14:06:24,800] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-04 14:06:24,800] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-04 14:06:24,800] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-04 14:06:24,800] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 3) for 3 partitions (state.change.logger)
[2023-02-04 14:06:24,973] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 3) for 0 partitions (state.change.logger)
[2023-02-04 14:06:24,973] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-04 14:06:24,973] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-04 14:06:24,973] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-04 14:06:27,786] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 0 (state.change.logger)
[2023-02-04 14:06:28,085] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 14:06:28,100] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 2 from offset 9 with partition epoch 2 and high watermark 9. Current leader is 0. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:28,100] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 3 from offset 7 with partition epoch 3 and high watermark 7. Current leader is 0. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:28,100] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 3 from offset 10 with partition epoch 3 and high watermark 10. Current leader is 0. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:28,226] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-04 14:06:27,959] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 0 (state.change.logger)
[2023-02-04 14:06:28,547] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 14:06:28,547] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 2 from offset 9 with partition epoch 2 and high watermark 9. Current leader is 0. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:28,547] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 3 from offset 7 with partition epoch 3 and high watermark 7. Current leader is 0. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:28,547] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 3 from offset 10 with partition epoch 3 and high watermark 10. Current leader is 0. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition test-topic-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition test-topic-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition test-topic-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition test-topic-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition library-events-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition library-events-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition library-events-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-49 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-38 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-27 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-16 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-8 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-19 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-13 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-35 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-24 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-46 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-43 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-21 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-32 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-10 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-37 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-48 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-18 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-29 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-40 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-7 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-45 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-34 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-23 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-26 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-4 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-15 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-42 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-31 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-9 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-20 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-12 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-28 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-17 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-6 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-39 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-44 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-47 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-36 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-25 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-14 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-30 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-41 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-11 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-33 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-22 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,602] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 10 for partition __consumer_offsets-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2023-02-04 14:06:28,901] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-04 14:06:29,615] INFO [Broker id=0] Finished LeaderAndIsr request in 1013ms correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-04 14:06:29,625] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2023-02-04 14:06:29,625] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 14:06:29,625] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 10 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-04 14:06:29,625] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 2 from offset 9 with partition epoch 2, high watermark 9, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:29,735] INFO [Broker id=3] Finished LeaderAndIsr request in 1650ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 14:06:29,735] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2023-02-04 14:06:29,750] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 4 (state.change.logger)
[2023-02-04 14:06:29,797] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition library-events-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-04 14:06:29,797] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition library-events-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-04 14:06:29,797] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-04 14:06:29,797] INFO [Broker id=1] Finished LeaderAndIsr request in 1250ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 14:06:29,797] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2023-02-04 14:06:29,829] INFO [Broker id=0] Finished LeaderAndIsr request in 204ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 14:06:29,829] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 4 (state.change.logger)
[2023-02-04 14:06:29,860] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2023-02-04 14:06:29,986] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 10 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-04 14:06:29,986] INFO [Broker id=0] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 3 from offset 7 with partition epoch 3, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:30,231] INFO [Broker id=0] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 3 from offset 10 with partition epoch 3, high watermark 10, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 0. (state.change.logger)
[2023-02-04 14:06:30,661] INFO [Broker id=0] Finished LeaderAndIsr request in 801ms correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2023-02-04 14:06:30,673] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 6 (state.change.logger)
[2023-02-04 14:06:30,677] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 8 (state.change.logger)
[2023-02-04 14:06:30,680] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 10 (state.change.logger)
[2023-02-04 14:06:31,023] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 14:06:31,023] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 3 (state.change.logger)
[2023-02-04 14:06:31,023] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 11 (state.change.logger)
[2023-02-04 14:06:31,039] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 5 (state.change.logger)
[2023-02-04 14:06:31,055] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-04 14:06:31,055] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 6 (state.change.logger)
[2023-02-04 14:06:31,055] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 12 (state.change.logger)
[2023-02-04 14:06:31,180] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 14:06:31,180] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 7 (state.change.logger)
[2023-02-04 14:06:31,180] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 13 (state.change.logger)
[2023-02-04 14:06:31,196] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-04 14:06:31,196] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 14 (state.change.logger)
[2023-02-04 14:06:31,196] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 8 (state.change.logger)
[2023-02-04 14:06:31,212] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 4 (state.change.logger)
[2023-02-04 14:06:31,212] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 5 (state.change.logger)
[2023-02-04 14:06:31,227] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 6 (state.change.logger)
[2023-02-04 14:11:29,964] INFO [Controller id=0 epoch=10] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=4, isr=List(0, 1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-04 14:11:29,964] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 14:11:29,964] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-04 14:11:29,964] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 14:11:29,964] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,965] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,965] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,965] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 4 from offset 7 with partition epoch 6 and high watermark 7. Current leader is 3. Previous leader epoch was 3. (state.change.logger)
[2023-02-04 14:11:29,965] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,965] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 4 from offset 7 with partition epoch 6 and high watermark 7. Current leader is 3. Previous leader epoch was 3. (state.change.logger)
[2023-02-04 14:11:29,966] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 15 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,967] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 0 epoch 10 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,967] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 7 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,967] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 4 from offset 7 with partition epoch 6, high watermark 7, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was 3. (state.change.logger)
[2023-02-04 14:11:29,971] INFO [Controller id=0 epoch=10] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(0, 1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-04 14:11:29,971] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-04 14:11:29,971] INFO [Broker id=3] Finished LeaderAndIsr request in 6ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,971] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 14:11:29,971] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 14:11:29,971] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,974] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 10 (state.change.logger)
[2023-02-04 14:11:29,975] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,976] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 4 from offset 10 with partition epoch 6 and high watermark 10. Current leader is 1. Previous leader epoch was 3. (state.change.logger)
[2023-02-04 14:11:29,978] INFO [Broker id=0] Finished LeaderAndIsr request in 13ms correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,978] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 11 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,980] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 16 (state.change.logger)
[2023-02-04 14:11:29,981] INFO [Broker id=1] Finished LeaderAndIsr request in 15ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,981] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,981] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 4 from offset 10 with partition epoch 6 and high watermark 10. Current leader is 1. Previous leader epoch was 3. (state.change.logger)
[2023-02-04 14:11:29,982] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 17 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,986] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 8 (state.change.logger)
[2023-02-04 14:11:29,991] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,995] INFO [Broker id=0] Finished LeaderAndIsr request in 14ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:29,999] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 18 (state.change.logger)
[2023-02-04 14:11:30,006] INFO [Broker id=3] Finished LeaderAndIsr request in 30ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:30,011] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 12 (state.change.logger)
[2023-02-04 14:11:30,021] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 0 epoch 10 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-04 14:11:30,022] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 4 from offset 10 with partition epoch 6, high watermark 10, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was 3. (state.change.logger)
[2023-02-04 14:11:30,026] INFO [Broker id=1] Finished LeaderAndIsr request in 36ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 14:11:30,028] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 10 (state.change.logger)
[2023-02-04 15:36:40,665] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-04 15:36:40,730] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 55 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-04 15:36:40,735] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-04 15:36:40,778] INFO [Controller id=0 epoch=11] Partition library-events-1 state changed to (Leader:-1,ISR:0,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:11) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 15:36:40,779] INFO [Controller id=0 epoch=11] Partition library-events-0 state changed to (Leader:3,ISR:0,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:11) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 15:36:40,780] INFO [Controller id=0 epoch=11] Partition library-events-2 state changed to (Leader:0,ISR:0,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:11) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 15:36:40,792] INFO [Controller id=0 epoch=11] Partition library-events-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 15:36:40,793] INFO [Controller id=0 epoch=11] Partition library-events-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 15:36:40,793] INFO [Controller id=0 epoch=11] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-04 15:36:40,793] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-04 15:36:40,793] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-04 15:36:40,831] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-04 15:36:40,833] INFO [Controller id=0 epoch=11] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=7, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2023-02-04 15:36:40,833] INFO [Controller id=0 epoch=11] Changed partition library-events-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=7, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2023-02-04 15:36:40,833] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-04 15:36:40,833] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 2 partitions (state.change.logger)
[2023-02-04 15:36:40,889] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 11 as part of the become-leader transition for 55 partitions (state.change.logger)
[2023-02-04 15:36:40,909] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,915] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,919] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,922] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 2 with partition epoch 2, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,925] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 15 with partition epoch 2, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,928] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,931] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,935] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,938] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,940] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,943] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,946] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 1 with partition epoch 2, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,949] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,976] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 2 from offset 9 with partition epoch 4, high watermark 9, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,983] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 1101 with partition epoch 2, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,986] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 4 with partition epoch 2, high watermark 4, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,986] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,989] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,991] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 139 with partition epoch 2, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,995] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:40,998] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,001] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,004] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,006] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,009] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,011] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 152 with partition epoch 2, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,014] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,017] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,020] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,023] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,026] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,030] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,033] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,036] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,039] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,041] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 2 from offset 3 with partition epoch 2, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,044] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,047] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,050] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,053] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,055] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,058] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,061] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,064] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,066] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,069] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,072] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 199 with partition epoch 2, high watermark 199, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,075] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,078] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,080] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,083] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,086] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,088] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,091] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,094] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,099] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition library-events-0 (last update controller epoch 10) but cannot become follower since the new leader 3 is unavailable. (state.change.logger)
[2023-02-04 15:36:41,100] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition library-events-1 (last update controller epoch 10) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2023-02-04 15:36:41,101] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 0 partitions (state.change.logger)
[2023-02-04 15:36:41,156] INFO [Broker id=0] Finished LeaderAndIsr request in 309ms correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-04 15:36:41,176] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2023-02-04 15:36:41,179] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 15:36:41,180] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 11 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-04 15:36:41,181] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 4 from offset 9 with partition epoch 6, high watermark 9, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-04 15:36:41,194] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 11 for partition library-events-0 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-04 15:36:41,194] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 11 for partition library-events-1 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-04 15:36:41,195] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-04 15:36:41,196] INFO [Broker id=0] Finished LeaderAndIsr request in 17ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 15:36:41,198] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2023-02-04 15:36:41,199] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2023-02-04 15:36:41,201] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 11 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-04 15:36:41,202] INFO [Broker id=0] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 7 from offset 7 with partition epoch 9, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,205] INFO [Broker id=0] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 7 from offset 10 with partition epoch 9, high watermark 10, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:36:41,208] INFO [Broker id=0] Finished LeaderAndIsr request in 9ms correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2023-02-04 15:36:41,211] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2023-02-04 15:37:00,425] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-04 15:37:00,428] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-04 15:37:00,435] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-04 15:37:00,436] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2023-02-04 15:37:00,437] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2023-02-04 15:37:00,717] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2023-02-04 15:37:00,742] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 15:37:00,772] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 4 from offset 9 with partition epoch 6 and high watermark 9. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:37:00,773] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 7 from offset 7 with partition epoch 9 and high watermark 7. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:37:00,773] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 7 from offset 10 with partition epoch 9 and high watermark 10. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:37:00,775] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-04 15:37:00,835] INFO [Broker id=1] Finished LeaderAndIsr request in 93ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 15:37:00,842] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2023-02-04 15:37:00,900] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1) for 1 partitions (state.change.logger)
[2023-02-04 15:37:00,902] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 9 (state.change.logger)
[2023-02-04 15:37:00,903] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 3 (state.change.logger)
[2023-02-04 15:37:00,921] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1) for 2 partitions (state.change.logger)
[2023-02-04 15:37:00,924] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 10 (state.change.logger)
[2023-02-04 15:37:00,924] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2023-02-04 15:37:14,476] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2023-02-04 15:37:14,478] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-04 15:37:14,480] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-04 15:37:14,480] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-04 15:37:14,482] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 12 (state.change.logger)
[2023-02-04 15:37:14,483] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2023-02-04 15:37:14,763] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2023-02-04 15:37:14,791] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 15:37:14,820] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 4 from offset 9 with partition epoch 7 and high watermark 9. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:37:14,821] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 7 from offset 7 with partition epoch 10 and high watermark 7. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:37:14,821] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 7 from offset 10 with partition epoch 10 and high watermark 10. Current leader is 0. Previous leader epoch was -1. (state.change.logger)
[2023-02-04 15:37:14,823] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-04 15:37:14,876] INFO [Broker id=3] Finished LeaderAndIsr request in 86ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-04 15:37:14,884] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2023-02-04 15:37:14,889] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 15:37:14,891] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 13 (state.change.logger)
[2023-02-04 15:37:14,891] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 7 (state.change.logger)
[2023-02-04 15:37:14,892] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 3 (state.change.logger)
[2023-02-04 15:37:14,899] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-04 15:37:14,902] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 14 (state.change.logger)
[2023-02-04 15:37:14,902] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2023-02-04 15:37:14,904] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2023-02-04 15:41:45,910] INFO [Controller id=0 epoch=11] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=8, isr=List(0, 1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=12) (state.change.logger)
[2023-02-04 15:41:45,910] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 15:41:45,911] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-04 15:41:45,911] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 15:41:45,912] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,912] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,912] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,913] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,914] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 8 from offset 7 with partition epoch 12 and high watermark 7. Current leader is 3. Previous leader epoch was 7. (state.change.logger)
[2023-02-04 15:41:45,915] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 8 from offset 7 with partition epoch 12 and high watermark 7. Current leader is 3. Previous leader epoch was 7. (state.change.logger)
[2023-02-04 15:41:45,916] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 15 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,917] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 9 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,919] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 11 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,919] INFO [Controller id=0 epoch=11] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=8, isr=List(0, 1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=12) (state.change.logger)
[2023-02-04 15:41:45,920] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-04 15:41:45,920] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 15:41:45,920] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-04 15:41:45,920] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,927] INFO [Broker id=1] Finished LeaderAndIsr request in 15ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,932] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 10 (state.change.logger)
[2023-02-04 15:41:45,934] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,937] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 8 from offset 7 with partition epoch 12, high watermark 7, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was 7. (state.change.logger)
[2023-02-04 15:41:45,946] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 0 epoch 11 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,953] INFO [Broker id=3] Finished LeaderAndIsr request in 40ms correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,957] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2023-02-04 15:41:45,960] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,961] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 8 from offset 10 with partition epoch 12 and high watermark 10. Current leader is 1. Previous leader epoch was 7. (state.change.logger)
[2023-02-04 15:41:45,963] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 7 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,969] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 8 from offset 10 with partition epoch 12, high watermark 10, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was 7. (state.change.logger)
[2023-02-04 15:41:45,983] INFO [Broker id=1] Finished LeaderAndIsr request in 49ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,987] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 12 (state.change.logger)
[2023-02-04 15:41:45,995] INFO [Broker id=3] Finished LeaderAndIsr request in 35ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:45,998] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2023-02-04 15:41:46,013] INFO [Broker id=0] Finished LeaderAndIsr request in 101ms correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:46,016] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 16 (state.change.logger)
[2023-02-04 15:41:46,017] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:46,018] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 8 from offset 10 with partition epoch 12 and high watermark 10. Current leader is 1. Previous leader epoch was 7. (state.change.logger)
[2023-02-04 15:41:46,026] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 17 for 1 partitions (state.change.logger)
[2023-02-04 15:41:46,041] INFO [Broker id=0] Finished LeaderAndIsr request in 24ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2023-02-04 15:41:46,049] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 18 (state.change.logger)
[2023-02-05 00:53:48,090] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-05 00:53:48,538] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-05 00:53:48,554] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(3) for 3 partitions (state.change.logger)
[2023-02-05 00:53:48,602] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-05 00:53:48,642] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition library-events-1 since its associated leader epoch 8 matches the current leader epoch (state.change.logger)
[2023-02-05 00:53:48,650] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition library-events-0 since its associated leader epoch 8 matches the current leader epoch (state.change.logger)
[2023-02-05 00:53:48,650] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition library-events-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 00:53:48,650] INFO [Broker id=3] Finished LeaderAndIsr request in 48ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-05 00:53:48,658] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,106] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,114] INFO [Controller id=3 epoch=12] Partition library-events-0 state changed to (Leader:3,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:13,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,114] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,114] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,114] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,122] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,130] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,138] INFO [Controller id=3 epoch=12] Partition library-events-2 state changed to (Leader:-1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,146] INFO [Controller id=3 epoch=12] Partition library-events-1 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:13,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,162] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,170] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,178] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,178] INFO [Controller id=3 epoch=12] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,202] INFO [Controller id=3 epoch=12] Partition library-events-1 state changed to (Leader:-1,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:12) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,210] INFO [Controller id=3 epoch=12] Partition library-events-0 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:12) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,210] INFO [Controller id=3 epoch=12] Partition library-events-2 state changed to (Leader:-1,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:10,ControllerEpoch:12) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 00:53:49,210] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-05 00:53:49,210] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-05 00:53:49,210] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-05 00:53:49,370] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 12 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-05 00:53:49,370] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 10 from offset 24 with partition epoch 14, high watermark 24, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 8. (state.change.logger)
[2023-02-05 00:53:49,458] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 12 for partition library-events-2 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:49,458] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 12 for partition library-events-1 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:49,458] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 12 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-05 00:53:49,458] INFO [Broker id=3] Finished LeaderAndIsr request in 248ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-05 00:53:49,466] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 4 (state.change.logger)
[2023-02-05 00:53:49,514] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,514] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,514] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,522] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,522] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,522] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,522] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,522] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,530] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,546] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,546] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,546] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,546] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,554] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,554] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,554] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,554] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,554] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,554] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,562] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,562] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,562] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,562] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,562] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,562] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,570] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,578] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,586] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,586] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,586] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 00:53:49,642] INFO [Controller id=3 epoch=12] Changed partition library-events-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=7, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-05 00:53:49,642] INFO [Controller id=3 epoch=12] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=11, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-05 00:53:49,642] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-05 00:53:49,642] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(3) for 2 partitions (state.change.logger)
[2023-02-05 00:53:49,650] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 3 for 2 partitions (state.change.logger)
[2023-02-05 00:53:49,730] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 12 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-05 00:53:49,738] INFO [Broker id=3] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 7 from offset 35 with partition epoch 11, high watermark 35, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-05 00:53:49,922] INFO [Broker id=3] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 11 from offset 27 with partition epoch 15, high watermark 27, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 8. (state.change.logger)
[2023-02-05 00:53:50,018] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-05 00:53:50,138] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1) for 57 partitions (state.change.logger)
[2023-02-05 00:53:50,162] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-05 00:53:50,162] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 57 become-follower partitions (state.change.logger)
[2023-02-05 00:53:50,162] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 57 partitions (state.change.logger)
[2023-02-05 00:53:50,146] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 0 (state.change.logger)
[2023-02-05 00:53:50,314] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-05 00:53:50,314] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 7 from offset 35 with partition epoch 11 and high watermark 35. Current leader is 3. Previous leader epoch was 4. (state.change.logger)
[2023-02-05 00:53:50,314] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 10 from offset 24 with partition epoch 14 and high watermark 24. Current leader is 3. Previous leader epoch was 8. (state.change.logger)
[2023-02-05 00:53:50,314] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 11 from offset 27 with partition epoch 15 and high watermark 27. Current leader is 3. Previous leader epoch was 8. (state.change.logger)
[2023-02-05 00:53:50,154] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 0 (state.change.logger)
[2023-02-05 00:53:50,322] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-05 00:53:50,322] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-0 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-48 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition test-topic-2 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-29 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-10 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-45 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-26 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-7 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-42 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-4 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-23 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition test-topic-3 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-1 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 7 from offset 35 with partition epoch 11 and high watermark 35. Current leader is 3. Previous leader epoch was 4. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-20 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-39 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-17 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-36 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition test-topic-0 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-14 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-33 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-49 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-11 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-30 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-46 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-27 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 10 from offset 24 with partition epoch 14 and high watermark 24. Current leader is 3. Previous leader epoch was 8. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-8 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-24 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-43 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-5 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-21 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-2 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-40 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-37 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-18 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition test-topic-1 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-34 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-15 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-12 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-31 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-9 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-47 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-19 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-28 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 11 from offset 27 with partition epoch 15 and high watermark 27. Current leader is 3. Previous leader epoch was 8. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-38 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-35 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-6 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-44 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-25 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-16 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-22 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-41 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-32 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-3 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,330] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 12 for partition __consumer_offsets-13 (last update controller epoch 12) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 00:53:50,370] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 12 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,498] INFO [Controller id=3 epoch=12] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 3 epoch 12 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,506] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,514] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=4) (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-05 00:53:50,522] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 54 partitions (state.change.logger)
[2023-02-05 00:53:50,994] INFO [Broker id=1] Finished LeaderAndIsr request in 680ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-05 00:53:51,010] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2023-02-05 00:53:51,026] INFO [Broker id=1] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 3 (state.change.logger)
[2023-02-05 00:53:51,122] INFO [Broker id=0] Finished LeaderAndIsr request in 800ms correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-05 00:53:51,130] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2023-02-05 00:53:51,170] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-05 00:53:51,178] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 12 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-05 00:53:51,178] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,186] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,194] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,202] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 4 from offset 2 with partition epoch 4, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,202] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 15 with partition epoch 4, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,210] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,210] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,218] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,218] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,226] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,234] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,242] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 4 from offset 1 with partition epoch 4, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,250] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,258] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 1101 with partition epoch 4, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,266] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 5 with partition epoch 4, high watermark 5, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,266] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,274] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,282] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 4 from offset 139 with partition epoch 4, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,290] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,290] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,298] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,458] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,466] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,474] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,474] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 152 with partition epoch 4, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,482] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,482] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,490] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,498] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 3 with partition epoch 4, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,506] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,506] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,514] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,522] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,522] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,530] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 4 from offset 3 with partition epoch 4, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,538] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,546] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,554] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,554] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,562] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,562] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,570] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,786] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:51,882] INFO [Broker id=3] Finished LeaderAndIsr request in 2232ms correlationId 5 from controller 3 for 2 partitions (state.change.logger)
[2023-02-05 00:53:51,930] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 6 (state.change.logger)
[2023-02-05 00:53:52,074] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 8 (state.change.logger)
[2023-02-05 00:53:52,082] INFO [Broker id=3] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 9 (state.change.logger)
[2023-02-05 00:53:52,194] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,266] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,306] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 199 with partition epoch 4, high watermark 199, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,346] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,354] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,362] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 45 with partition epoch 4, high watermark 45, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,362] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,378] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,394] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,402] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,402] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 4 from offset 0 with partition epoch 4, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 2. (state.change.logger)
[2023-02-05 00:53:52,410] INFO [Broker id=0] Finished LeaderAndIsr request in 1240ms correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-05 00:53:52,434] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 4 (state.change.logger)
[2023-02-05 00:53:52,538] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 00:53:52,546] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 5 (state.change.logger)
[2023-02-05 00:53:52,546] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 4 (state.change.logger)
[2023-02-05 00:53:52,562] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 10 (state.change.logger)
[2023-02-05 00:53:52,626] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-05 00:53:52,634] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 11 (state.change.logger)
[2023-02-05 00:53:52,642] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 6 (state.change.logger)
[2023-02-05 00:53:52,714] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 5 (state.change.logger)
[2023-02-05 00:53:52,850] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 00:53:52,858] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 12 (state.change.logger)
[2023-02-05 00:53:52,874] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 7 (state.change.logger)
[2023-02-05 00:53:52,898] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 6 (state.change.logger)
[2023-02-05 00:53:52,922] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 00:53:52,930] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 7 (state.change.logger)
[2023-02-05 00:53:52,930] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 8 (state.change.logger)
[2023-02-05 00:53:52,930] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 13 (state.change.logger)
[2023-02-05 00:53:52,962] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 00:53:52,970] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 14 (state.change.logger)
[2023-02-05 00:53:52,970] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 9 (state.change.logger)
[2023-02-05 00:53:52,970] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 8 (state.change.logger)
[2023-02-05 15:14:36,006] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-05 15:14:36,242] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-05 15:14:36,242] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-05 15:14:36,282] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-05 15:14:36,282] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition test-topic-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,282] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition test-topic-3 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition test-topic-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition test-topic-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition library-events-1 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition library-events-0 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition library-events-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-49 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-38 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-27 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-16 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-8 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-19 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-13 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-35 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-24 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-46 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-5 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-43 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-21 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-32 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-10 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-37 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,287] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-48 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-18 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-29 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-40 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-7 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-45 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-34 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-23 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-26 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-4 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-15 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-42 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-31 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-9 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-20 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-12 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-28 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-17 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-6 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-39 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-44 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-47 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-36 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-3 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-25 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-14 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-30 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-41 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-11 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-33 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-22 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition __consumer_offsets-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2023-02-05 15:14:36,288] INFO [Broker id=0] Finished LeaderAndIsr request in 6ms correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-05 15:14:36,292] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 2 (state.change.logger)
[2023-02-05 15:14:36,343] INFO [Controller id=0 epoch=13] Partition library-events-1 state changed to (Leader:3,ISR:3,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:13) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 15:14:36,343] INFO [Controller id=0 epoch=13] Partition library-events-0 state changed to (Leader:3,ISR:3,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:17,ControllerEpoch:13) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 15:14:36,343] INFO [Controller id=0 epoch=13] Partition library-events-2 state changed to (Leader:3,ISR:3,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:13) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 15:14:36,372] INFO [Controller id=0 epoch=13] Partition library-events-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:19,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 15:14:36,372] INFO [Controller id=0 epoch=13] Partition library-events-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:18,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 15:14:36,372] INFO [Controller id=0 epoch=13] Partition library-events-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:15,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-05 15:14:36,372] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-05 15:14:36,372] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,376] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,376] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 13 for partition library-events-2 (last update controller epoch 13) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 15:14:36,376] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 13 for partition library-events-0 (last update controller epoch 13) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 15:14:36,376] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 13 for partition library-events-1 (last update controller epoch 13) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-05 15:14:36,376] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-05 15:14:36,376] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,376] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 4 (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Controller id=0 epoch=13] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=14, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=20) (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Controller id=0 epoch=13] Changed partition library-events-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=19) (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Controller id=0 epoch=13] Changed partition library-events-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=16) (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 13 as part of the become-leader transition for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,384] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 10 from offset 35 with partition epoch 16, high watermark 35, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 7. (state.change.logger)
[2023-02-05 15:14:36,482] INFO [Broker id=0] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 13 from offset 24 with partition epoch 19, high watermark 24, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 10. (state.change.logger)
[2023-02-05 15:14:36,496] INFO [Broker id=0] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 14 from offset 27 with partition epoch 20, high watermark 27, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 11. (state.change.logger)
[2023-02-05 15:14:36,584] INFO [Broker id=0] Finished LeaderAndIsr request in 200ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,612] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 6 (state.change.logger)
[2023-02-05 15:14:36,680] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-05 15:14:36,682] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-05 15:14:36,682] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-05 15:14:36,682] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,692] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 8 (state.change.logger)
[2023-02-05 15:14:36,704] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2023-02-05 15:14:36,718] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,718] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 10 from offset 35 with partition epoch 16 and high watermark 35. Current leader is 0. Previous leader epoch was 7. (state.change.logger)
[2023-02-05 15:14:36,722] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 13 from offset 24 with partition epoch 19 and high watermark 24. Current leader is 0. Previous leader epoch was 10. (state.change.logger)
[2023-02-05 15:14:36,722] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 14 from offset 27 with partition epoch 20 and high watermark 27. Current leader is 0. Previous leader epoch was 11. (state.change.logger)
[2023-02-05 15:14:36,732] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,786] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1) for 1 partitions (state.change.logger)
[2023-02-05 15:14:36,792] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 9 (state.change.logger)
[2023-02-05 15:14:36,812] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1) for 2 partitions (state.change.logger)
[2023-02-05 15:14:36,812] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 10 (state.change.logger)
[2023-02-05 15:14:36,857] INFO [Broker id=1] Finished LeaderAndIsr request in 139ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:36,860] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 2 (state.change.logger)
[2023-02-05 15:14:36,862] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 3 (state.change.logger)
[2023-02-05 15:14:36,862] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 4 (state.change.logger)
[2023-02-05 15:14:37,084] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /brokers/topics/library-events/partitions/1/state
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:559)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$2(PartitionStateMachine.scala:403)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:379)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:877)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$5(KafkaController.scala:1271)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$5$adapted(KafkaController.scala:1250)
	at kafka.utils.Implicits$MapExtensionMethods$.$anonfun$forKeyValue$1(Implicits.scala:62)
	at scala.collection.compat.MapExtensionMethods$.$anonfun$foreachEntry$1(PackageShared.scala:521)
	at scala.collection.immutable.Map$Map3.foreach(Map.scala:376)
	at scala.collection.compat.MapExtensionMethods$.foreachEntry$extension(PackageShared.scala:521)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1250)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1289)
	at kafka.controller.KafkaController.process(KafkaController.scala:2549)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 15:14:37,197] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-05 15:14:37,302] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2023-02-05 15:14:37,307] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-05 15:14:37,312] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-05 15:14:37,312] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-05 15:14:37,313] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 12 (state.change.logger)
[2023-02-05 15:14:37,313] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 6 (state.change.logger)
[2023-02-05 15:14:37,322] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2023-02-05 15:14:37,322] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:37,327] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 10 from offset 35 with partition epoch 17 and high watermark 35. Current leader is 0. Previous leader epoch was 7. (state.change.logger)
[2023-02-05 15:14:37,327] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 13 from offset 24 with partition epoch 20 and high watermark 24. Current leader is 0. Previous leader epoch was 10. (state.change.logger)
[2023-02-05 15:14:37,327] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 14 from offset 27 with partition epoch 21 and high watermark 27. Current leader is 0. Previous leader epoch was 11. (state.change.logger)
[2023-02-05 15:14:37,330] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-05 15:14:37,367] INFO [Broker id=3] Finished LeaderAndIsr request in 45ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-05 15:14:37,372] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 2 (state.change.logger)
[2023-02-05 15:14:38,455] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 15:14:38,455] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 13 (state.change.logger)
[2023-02-05 15:14:38,455] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 3 (state.change.logger)
[2023-02-05 15:14:38,463] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 7 (state.change.logger)
[2023-02-05 15:14:38,471] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-05 15:14:38,479] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 14 (state.change.logger)
[2023-02-05 15:14:38,479] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 4 (state.change.logger)
[2023-02-05 15:14:38,535] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 8 (state.change.logger)
[2023-02-05 15:14:41,499] INFO [Controller id=0 epoch=13] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=14, isr=List(0, 1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=22) (state.change.logger)
[2023-02-05 15:14:41,499] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-05 15:14:41,499] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-05 15:14:41,499] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-05 15:14:41,499] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,502] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,502] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,502] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 14 from offset 24 with partition epoch 22 and high watermark 24. Current leader is 3. Previous leader epoch was 13. (state.change.logger)
[2023-02-05 15:14:41,502] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 15 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,515] INFO [Broker id=0] Finished LeaderAndIsr request in 13ms correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,515] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 16 (state.change.logger)
[2023-02-05 15:14:41,555] INFO [Controller id=0 epoch=13] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=15, isr=List(0, 1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=23) (state.change.logger)
[2023-02-05 15:14:41,555] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-05 15:14:41,555] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-05 15:14:41,555] INFO [Controller id=0 epoch=13] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-05 15:14:41,555] INFO [Controller id=0 epoch=13] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,563] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,563] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 15 from offset 27 with partition epoch 23 and high watermark 27. Current leader is 1. Previous leader epoch was 14. (state.change.logger)
[2023-02-05 15:14:41,563] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 17 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,571] INFO [Broker id=0] Finished LeaderAndIsr request in 8ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,602] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 13 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,602] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 14 from offset 24 with partition epoch 22, high watermark 24, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was 13. (state.change.logger)
[2023-02-05 15:14:41,611] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 18 (state.change.logger)
[2023-02-05 15:14:41,676] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:41,676] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 14 from offset 24 with partition epoch 22 and high watermark 24. Current leader is 3. Previous leader epoch was 13. (state.change.logger)
[2023-02-05 15:14:41,937] INFO [Broker id=3] Finished LeaderAndIsr request in 435ms correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:42,004] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 6 (state.change.logger)
[2023-02-05 15:14:42,012] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:42,012] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 15 from offset 27 with partition epoch 23 and high watermark 27. Current leader is 1. Previous leader epoch was 14. (state.change.logger)
[2023-02-05 15:14:42,276] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 9 for 1 partitions (state.change.logger)
[2023-02-05 15:14:42,308] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 13 with correlation id 7 for 1 partitions (state.change.logger)
[2023-02-05 15:14:42,417] INFO [Broker id=3] Finished LeaderAndIsr request in 405ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:42,420] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 8 (state.change.logger)
[2023-02-05 15:14:42,912] INFO [Broker id=1] Finished LeaderAndIsr request in 1236ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:42,912] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 10 (state.change.logger)
[2023-02-05 15:14:42,912] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:43,507] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 0 epoch 13 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-05 15:14:43,507] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 15 from offset 27 with partition epoch 23, high watermark 27, ISR [0,1,3], adding replicas [] and removing replicas []. Previous leader epoch was 14. (state.change.logger)
[2023-02-05 15:14:43,562] INFO [Broker id=1] Finished LeaderAndIsr request in 650ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2023-02-05 15:14:43,612] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 12 (state.change.logger)
[2023-02-06 00:42:45,591] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-06 00:42:45,623] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-06 00:42:45,623] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(3) for 3 partitions (state.change.logger)
[2023-02-06 00:42:45,795] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-06 00:42:45,795] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 14 for partition library-events-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2023-02-06 00:42:45,795] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 14 for partition library-events-0 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2023-02-06 00:42:45,795] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 14 for partition library-events-2 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2023-02-06 00:42:45,795] INFO [Broker id=3] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-06 00:42:45,968] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 2 (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition library-events-0 state changed to (Leader:3,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:23,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition library-events-2 state changed to (Leader:-1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:19,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:45,999] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,015] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,015] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition library-events-1 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,031] INFO [Controller id=3 epoch=14] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:14) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,047] INFO [Controller id=3 epoch=14] Partition library-events-1 state changed to (Leader:-1,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:25,ControllerEpoch:14) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,047] INFO [Controller id=3 epoch=14] Partition library-events-0 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:24,ControllerEpoch:14) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,047] INFO [Controller id=3 epoch=14] Partition library-events-2 state changed to (Leader:-1,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:20,ControllerEpoch:14) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-06 00:42:46,047] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-06 00:42:46,047] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-06 00:42:46,125] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,313] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 14 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 16 from offset 24 with partition epoch 24, high watermark 24, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 14. (state.change.logger)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,329] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,345] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,345] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,345] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,347] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] ERROR [Controller id=3 epoch=14] Controller 3 epoch 14 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-06 00:42:46,407] INFO [Controller id=3 epoch=14] Changed partition library-events-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=13, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=21) (state.change.logger)
[2023-02-06 00:42:46,407] INFO [Controller id=3 epoch=14] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=18, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=26) (state.change.logger)
[2023-02-06 00:42:46,407] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-06 00:42:46,423] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(3) for 2 partitions (state.change.logger)
[2023-02-06 00:42:46,659] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 14 for partition library-events-2 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:46,659] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 14 for partition library-events-1 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:46,659] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 14 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-06 00:42:46,659] INFO [Broker id=3] Finished LeaderAndIsr request in 534ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-06 00:42:46,675] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 4 (state.change.logger)
[2023-02-06 00:42:46,675] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 3 for 2 partitions (state.change.logger)
[2023-02-06 00:42:46,879] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 14 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-06 00:42:46,879] INFO [Broker id=3] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 13 from offset 35 with partition epoch 21, high watermark 35, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 10. (state.change.logger)
[2023-02-06 00:42:47,210] INFO [Broker id=3] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 18 from offset 27 with partition epoch 26, high watermark 27, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 15. (state.change.logger)
[2023-02-06 00:42:47,712] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-06 00:42:47,727] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-06 00:42:47,868] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 57 become-follower partitions (state.change.logger)
[2023-02-06 00:42:47,868] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 3) for 57 partitions (state.change.logger)
[2023-02-06 00:42:48,324] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,324] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,324] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,324] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,324] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-06 00:42:48,340] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 3) for 54 partitions (state.change.logger)
[2023-02-06 00:42:48,182] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 0 (state.change.logger)
[2023-02-06 00:42:48,449] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-0 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-48 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition test-topic-2 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-29 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-10 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-45 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-26 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-7 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-42 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,449] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-4 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-23 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition test-topic-3 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-1 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 13 from offset 35 with partition epoch 21 and high watermark 35. Current leader is 3. Previous leader epoch was 10. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-20 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-39 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-17 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-36 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition test-topic-0 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-14 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-33 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-49 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-11 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-30 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-46 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-27 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 16 from offset 24 with partition epoch 24 and high watermark 24. Current leader is 3. Previous leader epoch was 14. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-8 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-24 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-43 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-5 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-21 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-2 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-40 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-37 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-18 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition test-topic-1 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-34 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-15 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-12 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-31 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-9 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-47 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-19 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-28 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 18 from offset 27 with partition epoch 26 and high watermark 27. Current leader is 3. Previous leader epoch was 15. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-38 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-35 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-6 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-44 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-25 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-16 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-22 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-41 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-32 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-3 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,465] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 14 for partition __consumer_offsets-13 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-06 00:42:48,669] INFO [Broker id=3] Finished LeaderAndIsr request in 1994ms correlationId 5 from controller 3 for 2 partitions (state.change.logger)
[2023-02-06 00:42:48,669] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 6 (state.change.logger)
[2023-02-06 00:42:48,684] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 8 (state.change.logger)
[2023-02-06 00:42:48,684] INFO [Broker id=3] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 9 (state.change.logger)
[2023-02-06 00:42:48,841] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 3) for 0 partitions (state.change.logger)
[2023-02-06 00:42:48,841] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-06 00:42:48,856] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-06 00:42:48,856] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-06 00:42:48,856] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 11 (state.change.logger)
[2023-02-06 00:42:48,966] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 3 epoch 14 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-06 00:42:48,997] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:49,060] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 12 (state.change.logger)
[2023-02-06 00:42:49,076] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:49,076] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 13 (state.change.logger)
[2023-02-06 00:42:48,982] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 0 (state.change.logger)
[2023-02-06 00:42:49,437] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-06 00:42:49,453] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 13 from offset 35 with partition epoch 21 and high watermark 35. Current leader is 3. Previous leader epoch was 10. (state.change.logger)
[2023-02-06 00:42:49,453] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 16 from offset 24 with partition epoch 24 and high watermark 24. Current leader is 3. Previous leader epoch was 14. (state.change.logger)
[2023-02-06 00:42:49,453] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 18 from offset 27 with partition epoch 26 and high watermark 27. Current leader is 3. Previous leader epoch was 15. (state.change.logger)
[2023-02-06 00:42:49,484] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:49,484] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 14 (state.change.logger)
[2023-02-06 00:42:49,799] INFO [Broker id=0] Finished LeaderAndIsr request in 1350ms correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-06 00:42:49,829] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 14 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-06 00:42:49,876] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:49,876] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 2 (state.change.logger)
[2023-02-06 00:42:49,876] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 15 (state.change.logger)
[2023-02-06 00:42:49,876] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:49,892] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 16 (state.change.logger)
[2023-02-06 00:42:49,892] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-06 00:42:49,924] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 14 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-06 00:42:49,924] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:49,939] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:49,986] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,018] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:50,018] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 17 (state.change.logger)
[2023-02-06 00:42:50,065] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 6 from offset 2 with partition epoch 6, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,065] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 15 with partition epoch 6, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,080] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,080] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,127] INFO [Broker id=1] Finished LeaderAndIsr request in 690ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-06 00:42:50,127] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 2 (state.change.logger)
[2023-02-06 00:42:50,127] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 3 (state.change.logger)
[2023-02-06 00:42:50,127] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 4 (state.change.logger)
[2023-02-06 00:42:50,143] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 5 (state.change.logger)
[2023-02-06 00:42:50,143] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 6 (state.change.logger)
[2023-02-06 00:42:50,149] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 7 (state.change.logger)
[2023-02-06 00:42:50,149] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 8 (state.change.logger)
[2023-02-06 00:42:50,175] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,254] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,427] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,459] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,459] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 6 from offset 1 with partition epoch 6, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,474] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,474] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 1101 with partition epoch 6, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,490] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 5 with partition epoch 6, high watermark 5, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,500] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,506] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,506] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 6 from offset 139 with partition epoch 6, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,521] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,631] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,710] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,757] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,773] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,773] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,789] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 152 with partition epoch 6, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,789] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,805] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,805] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,820] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 7 with partition epoch 6, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,820] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,836] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,836] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,852] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,867] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,883] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 6 from offset 3 with partition epoch 6, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,898] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,900] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,914] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,914] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,930] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,930] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,930] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,946] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,946] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,961] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,961] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 199 with partition epoch 6, high watermark 199, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,977] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,977] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:50,993] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 45 with partition epoch 6, high watermark 45, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:51,009] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:51,024] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:51,024] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:51,024] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:51,040] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 6 from offset 0 with partition epoch 6, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was 4. (state.change.logger)
[2023-02-06 00:42:51,040] INFO [Broker id=0] Finished LeaderAndIsr request in 1148ms correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-06 00:42:51,087] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 4 (state.change.logger)
[2023-02-06 00:42:51,087] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 6 (state.change.logger)
[2023-02-06 00:42:51,087] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 7 (state.change.logger)
[2023-02-06 00:42:51,087] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 8 (state.change.logger)
[2023-02-06 00:42:51,101] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 9 (state.change.logger)
[2023-02-06 00:42:51,103] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 10 (state.change.logger)
[2023-02-06 00:42:51,103] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 11 (state.change.logger)
[2023-02-06 00:42:51,118] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 12 (state.change.logger)
[2023-02-06 00:42:51,502] INFO [Controller id=3 epoch=14] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=19, isr=List(3, 0, 1), leaderRecoveryState=RECOVERED, partitionEpoch=29) (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Controller id=3 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Controller id=3 epoch=14] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 13 from controller 3 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 18 from controller 3 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 19 from offset 27 with partition epoch 29 and high watermark 27. Current leader is 1. Previous leader epoch was 18. (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 19 from offset 27 with partition epoch 29 and high watermark 27. Current leader is 1. Previous leader epoch was 18. (state.change.logger)
[2023-02-06 00:42:51,511] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 14 with correlation id 18 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,526] INFO [Broker id=3] Finished LeaderAndIsr request in 15ms correlationId 18 from controller 3 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,526] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 19 (state.change.logger)
[2023-02-06 00:42:51,526] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 3 epoch 14 with correlation id 13 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,573] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 3 epoch 14 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,573] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 19 from offset 27 with partition epoch 29, high watermark 27, ISR [3,0,1], adding replicas [] and removing replicas []. Previous leader epoch was 18. (state.change.logger)
[2023-02-06 00:42:51,573] INFO [Broker id=1] Finished LeaderAndIsr request in 62ms correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,573] INFO [Broker id=0] Finished LeaderAndIsr request in 62ms correlationId 13 from controller 3 for 1 partitions (state.change.logger)
[2023-02-06 00:42:51,573] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 14 (state.change.logger)
[2023-02-06 00:42:51,573] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 14 with correlation id 10 (state.change.logger)
[2023-02-10 23:32:17,502] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-10 23:32:17,518] INFO [Controller id=3 epoch=15] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-10 23:32:17,518] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(3) for 3 partitions (state.change.logger)
[2023-02-10 23:32:17,955] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-10 23:32:17,955] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 15 for partition library-events-1 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2023-02-10 23:32:17,955] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 15 for partition library-events-0 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2023-02-10 23:32:17,955] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 15 for partition library-events-2 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2023-02-10 23:32:17,955] INFO [Broker id=3] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-10 23:32:17,988] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 2 (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition library-events-0 state changed to (Leader:3,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:27,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,004] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition library-events-2 state changed to (Leader:3,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:24,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition library-events-1 state changed to (Leader:1,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:30,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,012] INFO [Controller id=3 epoch=15] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,028] INFO [Controller id=3 epoch=15] Partition library-events-1 state changed to (Leader:-1,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:31,ControllerEpoch:15) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,028] INFO [Controller id=3 epoch=15] Partition library-events-0 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:28,ControllerEpoch:15) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,028] INFO [Controller id=3 epoch=15] Partition library-events-2 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:15) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-10 23:32:18,028] INFO [Controller id=3 epoch=15] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-10 23:32:18,028] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-10 23:32:18,055] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-10 23:32:18,155] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 15 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-10 23:32:18,155] INFO [Broker id=3] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 15 from offset 35 with partition epoch 25, high watermark 35, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 13. (state.change.logger)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,155] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,170] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,255] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,263] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,271] INFO [Controller id=3 epoch=15] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=22, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=32) (state.change.logger)
[2023-02-10 23:32:18,271] INFO [Controller id=3 epoch=15] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-10 23:32:18,271] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(3) for 1 partitions (state.change.logger)
[2023-02-10 23:32:18,388] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-10 23:32:18,388] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-10 23:32:18,388] INFO [Controller id=3 epoch=15] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-10 23:32:18,388] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(1, 3) for 3 partitions (state.change.logger)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,588] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,596] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,604] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] ERROR [Controller id=3 epoch=15] Controller 3 epoch 15 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-10 23:32:18,612] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-10 23:32:18,622] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 18 from offset 24 with partition epoch 28, high watermark 24, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 16. (state.change.logger)
[2023-02-10 23:32:18,622] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 15 for partition library-events-1 (last update controller epoch 15) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-10 23:32:18,622] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 15 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-10 23:32:18,622] INFO [Broker id=3] Finished LeaderAndIsr request in 567ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-10 23:32:18,759] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 0 (state.change.logger)
[2023-02-10 23:32:18,853] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 4 (state.change.logger)
[2023-02-10 23:32:18,853] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-10 23:32:18,853] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 15 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-10 23:32:18,853] INFO [Broker id=3] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 22 from offset 27 with partition epoch 32, high watermark 27, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 19. (state.change.logger)
[2023-02-10 23:32:18,853] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-10 23:32:18,868] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 15 from offset 35 with partition epoch 25 and high watermark 35. Current leader is 3. Previous leader epoch was 13. (state.change.logger)
[2023-02-10 23:32:18,868] INFO [Broker id=3] Finished LeaderAndIsr request in 15ms correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-10 23:32:18,884] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 18 from offset 24 with partition epoch 28 and high watermark 24. Current leader is 3. Previous leader epoch was 16. (state.change.logger)
[2023-02-10 23:32:18,884] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 22 from offset 27 with partition epoch 32 and high watermark 27. Current leader is 3. Previous leader epoch was 19. (state.change.logger)
[2023-02-10 23:32:18,884] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 15 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-10 23:32:18,884] INFO [Broker id=1] Finished LeaderAndIsr request in 31ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-10 23:32:18,900] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 2 (state.change.logger)
[2023-02-10 23:32:18,900] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 6 (state.change.logger)
[2023-02-10 23:32:18,915] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 8 (state.change.logger)
[2023-02-10 23:32:18,994] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(1, 3) for 1 partitions (state.change.logger)
[2023-02-10 23:32:19,010] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 9 (state.change.logger)
[2023-02-10 23:32:19,026] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(1, 3) for 2 partitions (state.change.logger)
[2023-02-10 23:32:19,026] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 10 (state.change.logger)
[2023-02-10 23:32:19,041] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 3 (state.change.logger)
[2023-02-10 23:32:19,041] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 4 (state.change.logger)
[2023-02-10 23:32:23,421] INFO [Controller id=3 epoch=15] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=23, isr=List(3, 1), leaderRecoveryState=RECOVERED, partitionEpoch=34) (state.change.logger)
[2023-02-10 23:32:23,421] INFO [Controller id=3 epoch=15] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-10 23:32:23,421] INFO [Controller id=3 epoch=15] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-10 23:32:23,421] INFO [Controller id=3 epoch=15] Sending UpdateMetadata request to brokers Set(1, 3) for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,430] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,461] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 11 from controller 3 for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,461] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 23 from offset 27 with partition epoch 34 and high watermark 27. Current leader is 1. Previous leader epoch was 22. (state.change.logger)
[2023-02-10 23:32:23,555] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 15 with correlation id 11 for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,571] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 15 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,571] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 23 from offset 27 with partition epoch 34, high watermark 27, ISR [3,1], adding replicas [] and removing replicas []. Previous leader epoch was 22. (state.change.logger)
[2023-02-10 23:32:23,571] INFO [Broker id=3] Finished LeaderAndIsr request in 110ms correlationId 11 from controller 3 for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,603] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 12 (state.change.logger)
[2023-02-10 23:32:23,808] INFO [Broker id=1] Finished LeaderAndIsr request in 378ms correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-10 23:32:23,824] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 15 with correlation id 6 (state.change.logger)
[2023-02-11 03:05:15,029] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers Set(1, 3) for 0 partitions (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers Set(1, 3) for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 16 for partition library-events-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 16 for partition library-events-0 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 16 for partition library-events-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Broker id=3] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,045] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 2 (state.change.logger)
[2023-02-11 03:05:15,038] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,045] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 16 for partition library-events-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,045] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 16 for partition library-events-0 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,045] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 16 for partition library-events-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,045] INFO [Broker id=1] Finished LeaderAndIsr request in 7ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,061] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 2 (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition library-events-0 state changed to (Leader:3,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:29,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition library-events-2 state changed to (Leader:3,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:26,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition library-events-1 state changed to (Leader:1,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:34,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers Set(1, 3) for 57 partitions (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,092] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 16 for partition library-events-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 16 for partition library-events-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 16 for partition library-events-0 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 16 for partition library-events-0 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 16 for partition library-events-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 16 for partition library-events-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=1] Finished LeaderAndIsr request in 31ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=3] Finished LeaderAndIsr request in 31ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 4 (state.change.logger)
[2023-02-11 03:05:15,123] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 4 (state.change.logger)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,123] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,138] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,138] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,138] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,138] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,138] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 03:05:15,139] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 14:01:59,990] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-11 14:02:00,324] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 14:02:00,324] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(3) for 3 partitions (state.change.logger)
[2023-02-11 14:02:00,555] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition library-events-0 state changed to (Leader:3,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:29,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,712] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,725] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition library-events-2 state changed to (Leader:3,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:26,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition library-events-1 state changed to (Leader:1,ISR:3,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:34,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,728] INFO [Controller id=3 epoch=17] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,759] INFO [Controller id=3 epoch=17] Partition library-events-1 state changed to (Leader:-1,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:24,ZkVersion:35,ControllerEpoch:17) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,759] INFO [Controller id=3 epoch=17] Partition library-events-0 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:30,ControllerEpoch:17) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,759] INFO [Controller id=3 epoch=17] Partition library-events-2 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:27,ControllerEpoch:17) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 14:02:00,759] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 14:02:00,759] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,948] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,964] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2531)
	at kafka.controller.KafkaController.process(KafkaController.scala:2573)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:00,979] INFO [Controller id=3 epoch=17] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=25, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=36) (state.change.logger)
[2023-02-11 14:02:00,979] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 14:02:00,979] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(3) for 1 partitions (state.change.logger)
[2023-02-11 14:02:01,152] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-11 14:02:01,304] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-11 14:02:01,304] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 14:02:01,304] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 3 partitions (state.change.logger)
[2023-02-11 14:02:01,384] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,384] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,384] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,384] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,384] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,392] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,392] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,502] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,517] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,532] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,532] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:539)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1594)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 14:02:01,533] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 17 for partition library-events-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 17 for partition library-events-0 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 17 for partition library-events-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 2 (state.change.logger)
[2023-02-11 14:02:07,185] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,222] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 17 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-11 14:02:07,222] INFO [Broker id=3] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 16 from offset 35 with partition epoch 27, high watermark 35, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 15. (state.change.logger)
[2023-02-11 14:02:07,222] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 19 from offset 24 with partition epoch 30, high watermark 24, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 18. (state.change.logger)
[2023-02-11 14:02:07,232] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 17 for partition library-events-1 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 14:02:07,232] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 17 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-11 14:02:07,232] INFO [Broker id=3] Finished LeaderAndIsr request in 47ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,232] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 4 (state.change.logger)
[2023-02-11 14:02:07,232] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 14:02:07,248] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 14:02:07,248] INFO [Broker id=3] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 25 from offset 27 with partition epoch 36, high watermark 27, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was 23. (state.change.logger)
[2023-02-11 14:02:07,232] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 0 (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 16 from offset 35 with partition epoch 27 and high watermark 35. Current leader is 3. Previous leader epoch was 15. (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 19 from offset 24 with partition epoch 30 and high watermark 24. Current leader is 3. Previous leader epoch was 18. (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 25 from offset 27 with partition epoch 36 and high watermark 27. Current leader is 3. Previous leader epoch was 23. (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 17 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=3] Finished LeaderAndIsr request in 19ms correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 14:02:07,251] INFO [Broker id=1] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 14:02:07,264] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 6 (state.change.logger)
[2023-02-11 14:02:07,264] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 2 (state.change.logger)
[2023-02-11 14:02:07,264] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 8 (state.change.logger)
[2023-02-11 14:02:07,280] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 1 partitions (state.change.logger)
[2023-02-11 14:02:07,280] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 9 (state.change.logger)
[2023-02-11 14:02:07,280] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 3 (state.change.logger)
[2023-02-11 14:02:07,311] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 2 partitions (state.change.logger)
[2023-02-11 14:02:07,311] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 10 (state.change.logger)
[2023-02-11 14:02:07,311] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 4 (state.change.logger)
[2023-02-11 14:06:59,683] INFO [Controller id=3 epoch=17] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=26, isr=List(3, 1), leaderRecoveryState=RECOVERED, partitionEpoch=38) (state.change.logger)
[2023-02-11 14:06:59,683] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 14:06:59,683] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 14:06:59,683] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,683] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,683] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 11 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,690] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 26 from offset 27 with partition epoch 38 and high watermark 27. Current leader is 1. Previous leader epoch was 25. (state.change.logger)
[2023-02-11 14:06:59,691] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 17 with correlation id 11 for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,694] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,695] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 26 from offset 27 with partition epoch 38, high watermark 27, ISR [3,1], adding replicas [] and removing replicas []. Previous leader epoch was 25. (state.change.logger)
[2023-02-11 14:06:59,700] INFO [Broker id=1] Finished LeaderAndIsr request in 17ms correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,700] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 6 (state.change.logger)
[2023-02-11 14:06:59,700] INFO [Broker id=3] Finished LeaderAndIsr request in 17ms correlationId 11 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 14:06:59,700] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 12 (state.change.logger)
[2023-02-11 15:29:23,715] INFO [Controller id=3 epoch=17] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=20, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=32) (state.change.logger)
[2023-02-11 15:29:23,720] INFO [Controller id=3 epoch=17] Changed partition library-events-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=17, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=29) (state.change.logger)
[2023-02-11 15:29:23,721] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:23,723] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-11 15:29:23,724] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,730] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:23,732] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 13 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,732] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,739] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 17 from offset 35 with partition epoch 29 and high watermark 35. Current leader is 1. Previous leader epoch was 16. (state.change.logger)
[2023-02-11 15:29:23,742] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 20 from offset 24 with partition epoch 32 and high watermark 24. Current leader is 1. Previous leader epoch was 19. (state.change.logger)
[2023-02-11 15:29:23,743] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 17 with correlation id 13 for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,743] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 3 epoch 17 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,744] INFO [Controller id=3 epoch=17] Sending StopReplica request for 1 replicas to broker 3 (state.change.logger)
[2023-02-11 15:29:23,744] INFO [Broker id=1] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 17 from offset 35 with partition epoch 29, high watermark 35, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was 16. (state.change.logger)
[2023-02-11 15:29:23,751] INFO [Broker id=3] Finished LeaderAndIsr request in 19ms correlationId 13 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,760] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 14 (state.change.logger)
[2023-02-11 15:29:23,760] INFO [Broker id=1] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 20 from offset 24 with partition epoch 32, high watermark 24, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was 19. (state.change.logger)
[2023-02-11 15:29:23,765] INFO [Broker id=3] Handling StopReplica request correlationId 15 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:29:23,779] INFO [Controller id=3 epoch=17] Partition library-events-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:23,780] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:23,780] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:29:23,780] INFO [Broker id=1] Finished LeaderAndIsr request in 49ms correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:29:23,780] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 15 epoch 17 for partition library-events-1 since its associated leader epoch 26 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,782] INFO [Controller id=3 epoch=17] Sending StopReplica request for 1 replicas to broker 3 (state.change.logger)
[2023-02-11 15:29:23,782] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 8 (state.change.logger)
[2023-02-11 15:29:23,787] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:29:23,790] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 3 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:29:23,791] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 27 from offset 27 with partition epoch 39, high watermark 27, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was 26. (state.change.logger)
[2023-02-11 15:29:23,796] INFO [Broker id=1] Finished LeaderAndIsr request in 10ms correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:29:23,798] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 10 (state.change.logger)
[2023-02-11 15:29:23,806] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 16 (state.change.logger)
[2023-02-11 15:29:23,809] INFO [Broker id=3] Handling StopReplica request correlationId 17 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:29:23,810] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 17 epoch 17 for partition library-events-1 since its associated leader epoch 26 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,813] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:23,813] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:23,813] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:23,814] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:23,815] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:23,822] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:23,823] INFO [Controller id=3 epoch=17] Sending StopReplica request for 3 replicas to broker 3 (state.change.logger)
[2023-02-11 15:29:23,826] INFO [Broker id=3] Handling StopReplica request correlationId 18 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:29:23,826] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 18 epoch 17 for partition library-events-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,826] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 18 epoch 17 for partition library-events-0 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,829] INFO [Controller id=3 epoch=17] Partition library-events-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:23,830] INFO [Controller id=3 epoch=17] Partition library-events-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:32,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:23,830] INFO [Controller id=3 epoch=17] Partition library-events-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:23,830] INFO [Controller id=3 epoch=17] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:23,830] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set(1, 3) for 3 partitions (state.change.logger)
[2023-02-11 15:29:23,831] INFO [Controller id=3 epoch=17] Sending StopReplica request for 3 replicas to broker 3 (state.change.logger)
[2023-02-11 15:29:23,832] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:29:23,832] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 11 epoch 17 for partition library-events-1 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,832] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 11 epoch 17 for partition library-events-0 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,832] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 11 epoch 17 for partition library-events-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,833] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:29:23,841] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 19 (state.change.logger)
[2023-02-11 15:29:23,844] INFO [Broker id=3] Handling StopReplica request correlationId 20 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:29:23,844] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 20 epoch 17 for partition library-events-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,845] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 20 epoch 17 for partition library-events-0 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:23,845] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 17 with correlation id 12 (state.change.logger)
[2023-02-11 15:29:23,860] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:23,860] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:23,860] ERROR [Controller id=3 epoch=17] Controller 3 epoch 17 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:23,861] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:23,861] INFO [Controller id=3 epoch=17] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:24,459] INFO [Controller id=1 epoch=18] Sending UpdateMetadata request to brokers Set(1) for 0 partitions (state.change.logger)
[2023-02-11 15:29:24,539] INFO [Controller id=1 epoch=18] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:24,545] INFO [Controller id=1 epoch=18] Sending UpdateMetadata request to brokers Set(1) for 3 partitions (state.change.logger)
[2023-02-11 15:29:24,547] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:29:24,547] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 18 for partition library-events-1 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:24,547] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 18 for partition library-events-0 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:24,547] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 18 for partition library-events-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:24,548] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:29:24,556] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 18 with correlation id 2 (state.change.logger)
[2023-02-11 15:29:24,709] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,710] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,710] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,710] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,711] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,711] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,711] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,712] INFO [Controller id=1 epoch=18] Partition library-events-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:32,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,712] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,712] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,713] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,713] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,713] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,713] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,713] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,714] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,714] INFO [Controller id=1 epoch=18] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,714] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,714] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,714] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,715] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,715] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,716] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,716] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,718] INFO [Controller id=1 epoch=18] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,719] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,720] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,721] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,721] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,722] INFO [Controller id=1 epoch=18] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,722] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,722] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,722] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,722] INFO [Controller id=1 epoch=18] Partition library-events-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,723] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,724] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,724] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition library-events-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,725] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,726] INFO [Controller id=1 epoch=18] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:18) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,738] INFO [Controller id=1 epoch=18] Partition library-events-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,739] INFO [Controller id=1 epoch=18] Partition library-events-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:32,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,739] INFO [Controller id=1 epoch=18] Partition library-events-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:24,740] INFO [Controller id=1 epoch=18] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:24,741] INFO [Controller id=1 epoch=18] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-11 15:29:24,742] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:29:24,742] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 18 for partition library-events-1 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:24,742] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 18 for partition library-events-0 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:24,742] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 18 for partition library-events-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2023-02-11 15:29:24,742] INFO [Broker id=1] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:29:24,744] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 18 with correlation id 4 (state.change.logger)
[2023-02-11 15:29:24,859] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,860] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,860] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,860] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,861] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,861] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,861] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,862] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,862] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,862] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,863] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,863] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,864] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,864] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,865] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,866] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,868] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,869] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,869] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,870] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,873] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,875] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,876] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,876] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,876] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,876] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,876] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,876] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,877] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,877] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,878] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,878] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,878] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,879] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,879] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,879] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,879] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,880] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,880] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,880] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,880] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,881] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:24,885] INFO [Controller id=1 epoch=18] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:28,961] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:28,962] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:28,963] ERROR [Controller id=1 epoch=18] Controller 1 epoch 18 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1346)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1308)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1308)
	at kafka.controller.KafkaController.process(KafkaController.scala:2557)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:28,964] INFO [Controller id=1 epoch=18] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:28,967] INFO [Controller id=1 epoch=18] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:29:51,319] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-11 15:29:51,681] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 57 become-follower partitions (state.change.logger)
[2023-02-11 15:29:51,690] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-11 15:29:51,956] INFO [Controller id=0 epoch=19] Partition library-events-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:28,ZkVersion:40,ControllerEpoch:19) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:51,958] INFO [Controller id=0 epoch=19] Partition library-events-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:33,ControllerEpoch:19) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:51,958] INFO [Controller id=0 epoch=19] Partition library-events-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:30,ControllerEpoch:19) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:51,988] INFO [Controller id=0 epoch=19] Partition library-events-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:28,ZkVersion:40,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:51,989] INFO [Controller id=0 epoch=19] Partition library-events-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:33,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:51,989] INFO [Controller id=0 epoch=19] Partition library-events-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:30,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:29:51,990] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:29:51,991] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-11 15:29:52,179] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-11 15:29:52,593] ERROR [Controller id=0 epoch=19] Controller 0 epoch 19 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:52,601] ERROR [Controller id=0 epoch=19] Controller 0 epoch 19 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:52,601] ERROR [Controller id=0 epoch=19] Controller 0 epoch 19 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1427)
	at kafka.controller.KafkaController.process(KafkaController.scala:2601)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,604] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,605] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,605] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,605] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,606] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,607] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,608] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,608] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,609] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,609] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,609] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,609] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,609] INFO [Controller id=0 epoch=19] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=11) (state.change.logger)
[2023-02-11 15:29:52,609] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:52,609] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-0 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,610] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0) for 54 partitions (state.change.logger)
[2023-02-11 15:29:52,798] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-48 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,824] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-11 15:29:52,833] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(1) for 57 partitions (state.change.logger)
[2023-02-11 15:29:52,867] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition test-topic-2 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,871] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-29 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,871] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:29:52,872] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2023-02-11 15:29:52,887] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-10 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,891] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-45 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,901] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-26 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,902] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-7 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,904] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-42 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,905] INFO [Controller id=0 epoch=19] Changed partition library-events-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=29, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=41) (state.change.logger)
[2023-02-11 15:29:52,905] INFO [Controller id=0 epoch=19] Changed partition library-events-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=22, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=34) (state.change.logger)
[2023-02-11 15:29:52,905] INFO [Controller id=0 epoch=19] Changed partition library-events-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=19, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=31) (state.change.logger)
[2023-02-11 15:29:52,905] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:29:52,906] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-4 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,906] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:29:52,906] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2023-02-11 15:29:52,907] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-23 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,910] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition test-topic-3 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,917] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-1 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,918] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition library-events-2 (last update controller epoch 17) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,919] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-20 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,954] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-39 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,968] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-17 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,969] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-36 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,969] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition test-topic-0 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,974] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-14 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,985] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-33 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,986] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-49 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,987] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-11 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,987] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-30 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,988] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-46 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:52,994] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-27 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,000] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition library-events-0 (last update controller epoch 17) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,001] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-8 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,004] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-24 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,004] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-43 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,004] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-5 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,005] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-21 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,014] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-2 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,017] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-40 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,018] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-37 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,018] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-18 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,019] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition test-topic-1 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,019] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-34 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,020] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-15 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,020] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-12 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,023] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-31 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,027] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-9 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,032] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-47 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,032] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-19 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,034] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-28 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,035] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition library-events-1 (last update controller epoch 17) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,036] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-38 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,036] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-35 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,036] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-6 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,037] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-44 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,038] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-25 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,040] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-16 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,041] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-22 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,042] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-41 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,046] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-32 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,048] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-3 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,049] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition __consumer_offsets-13 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,053] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 19 with correlation id 1 for 0 partitions (state.change.logger)
[2023-02-11 15:29:53,099] INFO [Broker id=0] Finished LeaderAndIsr request in 923ms correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-11 15:29:53,135] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 2 (state.change.logger)
[2023-02-11 15:29:53,138] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:53,138] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 19 for partition library-events-2 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,139] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 19 for partition library-events-0 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,140] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 19 for partition library-events-1 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:53,140] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 19 with correlation id 3 for 0 partitions (state.change.logger)
[2023-02-11 15:29:53,143] INFO [Broker id=0] Finished LeaderAndIsr request in 5ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:53,150] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 4 (state.change.logger)
[2023-02-11 15:29:53,154] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 54 partitions (state.change.logger)
[2023-02-11 15:29:53,182] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 19 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-11 15:29:53,214] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,268] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,274] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,282] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 11 from offset 2 with partition epoch 11, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,301] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 15 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,312] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,317] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,320] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,327] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,333] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,336] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,339] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 11 from offset 1 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,348] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,355] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 1101 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,365] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 5 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,369] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,372] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,381] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 11 from offset 139 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,384] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,389] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,399] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,403] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,409] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,417] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,420] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 152 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,434] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,449] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,453] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,467] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 7 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,472] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,483] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,502] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,514] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,518] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,527] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 11 from offset 3 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,533] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,538] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,551] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,562] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,567] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,571] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,584] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,588] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,600] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,603] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,611] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 199 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,617] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,620] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,626] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 45 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,633] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,637] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,646] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,650] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,653] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 11 from offset 0 with partition epoch 11, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:53,716] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 0 (state.change.logger)
[2023-02-11 15:29:53,936] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,112] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition library-events-2 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:54,168] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition library-events-0 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:54,169] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 19 for partition library-events-1 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:29:54,177] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 19 with correlation id 1 for 0 partitions (state.change.logger)
[2023-02-11 15:29:54,237] INFO [Broker id=0] Finished LeaderAndIsr request in 1083ms correlationId 5 from controller 0 for 54 partitions (state.change.logger)
[2023-02-11 15:29:54,252] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 6 (state.change.logger)
[2023-02-11 15:29:54,267] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 8 (state.change.logger)
[2023-02-11 15:29:54,269] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,277] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 19 from offset 35 with partition epoch 31 and high watermark 0. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:54,278] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 22 from offset 24 with partition epoch 34 and high watermark 0. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:54,279] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 29 from offset 27 with partition epoch 41 and high watermark 0. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:54,303] INFO [Broker id=1] Finished LeaderAndIsr request in 376ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,317] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 19 with correlation id 9 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,332] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 2 (state.change.logger)
[2023-02-11 15:29:54,340] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,414] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 19 as part of the become-leader transition for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,456] INFO [Broker id=1] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 19 from offset 35 with partition epoch 31, high watermark 35, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:54,488] INFO [Broker id=1] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 22 from offset 24 with partition epoch 34, high watermark 24, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:54,498] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 29 from offset 27 with partition epoch 41, high watermark 27, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:54,500] INFO [Broker id=0] Finished LeaderAndIsr request in 231ms correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,505] INFO [Broker id=1] Finished LeaderAndIsr request in 165ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:54,511] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 10 (state.change.logger)
[2023-02-11 15:29:54,513] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 4 (state.change.logger)
[2023-02-11 15:29:54,784] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1) for 1 partitions (state.change.logger)
[2023-02-11 15:29:54,787] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 11 (state.change.logger)
[2023-02-11 15:29:54,793] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 5 (state.change.logger)
[2023-02-11 15:29:54,920] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1) for 2 partitions (state.change.logger)
[2023-02-11 15:29:54,927] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 6 (state.change.logger)
[2023-02-11 15:29:54,929] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 12 (state.change.logger)
[2023-02-11 15:29:58,145] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2023-02-11 15:29:58,145] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(3) for 57 partitions (state.change.logger)
[2023-02-11 15:29:58,160] INFO [Controller id=0 epoch=19] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:29:58,161] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-11 15:29:58,163] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 14 (state.change.logger)
[2023-02-11 15:29:58,164] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 8 (state.change.logger)
[2023-02-11 15:29:58,845] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 0 (state.change.logger)
[2023-02-11 15:29:58,950] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:59,078] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 19 from offset 35 with partition epoch 32 and high watermark 35. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:59,080] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 22 from offset 24 with partition epoch 35 and high watermark 24. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:59,081] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 29 from offset 27 with partition epoch 42 and high watermark 27. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:29:59,097] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 19 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-11 15:29:59,245] INFO [Broker id=3] Finished LeaderAndIsr request in 297ms correlationId 1 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:29:59,260] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 2 (state.change.logger)
[2023-02-11 15:29:59,265] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:29:59,274] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 15 (state.change.logger)
[2023-02-11 15:29:59,277] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 9 (state.change.logger)
[2023-02-11 15:29:59,280] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 3 (state.change.logger)
[2023-02-11 15:29:59,286] INFO [Controller id=0 epoch=19] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-11 15:29:59,295] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 16 (state.change.logger)
[2023-02-11 15:29:59,296] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 10 (state.change.logger)
[2023-02-11 15:29:59,296] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 4 (state.change.logger)
[2023-02-11 15:30:18,136] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 0 partitions (state.change.logger)
[2023-02-11 15:30:18,232] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:30:18,236] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:30:18,236] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,236] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,236] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 20 for partition library-events-1 since its associated leader epoch 29 matches the current leader epoch (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 20 for partition library-events-1 since its associated leader epoch 29 matches the current leader epoch (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 20 for partition library-events-0 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 20 for partition library-events-0 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 20 for partition library-events-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 20 for partition library-events-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=1] Finished LeaderAndIsr request in 8ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,244] INFO [Broker id=3] Finished LeaderAndIsr request in 8ms correlationId 1 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,251] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 2 (state.change.logger)
[2023-02-11 15:30:18,255] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 2 (state.change.logger)
[2023-02-11 15:30:18,415] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,421] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,421] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,424] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,424] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition library-events-0 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:37,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition library-events-2 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:34,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,425] INFO [Controller id=3 epoch=20] Partition library-events-1 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:30,ZkVersion:44,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,433] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,433] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,433] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,434] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,434] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,435] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,435] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:30:18,436] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 57 partitions (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 20 from offset 35 with partition epoch 34 and high watermark 35. Current leader is 1. Previous leader epoch was 19. (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 20 as part of the become-leader transition for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 23 from offset 24 with partition epoch 37 and high watermark 24. Current leader is 1. Previous leader epoch was 22. (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 30 from offset 27 with partition epoch 44 and high watermark 27. Current leader is 1. Previous leader epoch was 29. (state.change.logger)
[2023-02-11 15:30:18,444] INFO [Broker id=1] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 20 from offset 35 with partition epoch 34, high watermark 35, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 19. (state.change.logger)
[2023-02-11 15:30:18,464] INFO [Broker id=1] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 23 from offset 24 with partition epoch 37, high watermark 24, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 22. (state.change.logger)
[2023-02-11 15:30:18,464] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,467] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 30 from offset 27 with partition epoch 44, high watermark 27, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 29. (state.change.logger)
[2023-02-11 15:30:18,469] INFO [Broker id=3] Finished LeaderAndIsr request in 24ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,477] INFO [Broker id=1] Finished LeaderAndIsr request in 33ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:30:18,477] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 4 (state.change.logger)
[2023-02-11 15:30:18,477] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 4 (state.change.logger)
[2023-02-11 15:30:18,550] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,556] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,556] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,557] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,557] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,558] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,558] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,558] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,558] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,559] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,565] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,566] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,566] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,566] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,567] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,567] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,570] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,573] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,575] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,576] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,576] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,576] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,576] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,576] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:270)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2526)
	at kafka.controller.KafkaController.process(KafkaController.scala:2571)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:30:18,577] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:30:23,701] INFO [Controller id=3 epoch=20] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=24, isr=List(1, 3), leaderRecoveryState=RECOVERED, partitionEpoch=38) (state.change.logger)
[2023-02-11 15:30:23,701] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 15:30:23,705] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:30:23,705] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,705] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,705] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,712] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 24 from offset 24 with partition epoch 38 and high watermark 24. Current leader is 3. Previous leader epoch was 23. (state.change.logger)
[2023-02-11 15:30:23,712] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 5 for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,716] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 3 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,738] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 24 from offset 24 with partition epoch 38, high watermark 24, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 23. (state.change.logger)
[2023-02-11 15:30:23,770] INFO [Broker id=3] Finished LeaderAndIsr request in 65ms correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,775] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 6 (state.change.logger)
[2023-02-11 15:30:23,797] INFO [Broker id=1] Finished LeaderAndIsr request in 92ms correlationId 5 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:30:23,807] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 6 (state.change.logger)
[2023-02-11 15:33:21,265] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 0 partitions (state.change.logger)
[2023-02-11 15:33:21,268] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-11 15:33:21,275] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 57 become-follower partitions (state.change.logger)
[2023-02-11 15:33:21,277] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 57 partitions (state.change.logger)
[2023-02-11 15:33:21,278] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 8 (state.change.logger)
[2023-02-11 15:33:21,278] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 8 (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,327] INFO [Controller id=3 epoch=20] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,328] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=13) (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:33:21,329] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 54 partitions (state.change.logger)
[2023-02-11 15:33:21,333] INFO [Broker id=3] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 9 (state.change.logger)
[2023-02-11 15:33:21,333] INFO [Broker id=1] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 9 (state.change.logger)
[2023-02-11 15:33:21,634] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 0 (state.change.logger)
[2023-02-11 15:33:21,661] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-11 15:33:21,723] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-0 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,733] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-48 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,733] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-2 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,734] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-29 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,734] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-10 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,734] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-45 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,735] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-26 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,735] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-7 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,735] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-42 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,735] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-4 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,735] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-23 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,735] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-3 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,736] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-1 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,738] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 20 from offset 35 with partition epoch 34 and high watermark 35. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,738] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-20 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,739] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-39 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,739] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-17 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,739] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-36 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,739] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-0 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,739] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-14 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,740] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-33 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,740] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-49 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,740] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-11 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,740] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-30 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,740] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-46 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,741] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-27 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,741] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 24 from offset 24 with partition epoch 38 and high watermark 24. Current leader is 3. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,741] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-8 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-24 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-43 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-5 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-21 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-2 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-40 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,743] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-37 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,743] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-18 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,743] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-1 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,744] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-34 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,744] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-15 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,744] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-12 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,744] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-31 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,744] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-9 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,744] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-47 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,745] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-19 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,745] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-28 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,745] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 30 from offset 27 with partition epoch 44 and high watermark 27. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,745] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-38 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,746] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-35 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,746] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-6 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-44 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-25 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-16 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-22 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-41 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-32 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-3 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,748] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-13 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:33:21,750] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-11 15:33:21,799] INFO [Broker id=0] Finished LeaderAndIsr request in 138ms correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-11 15:33:21,809] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 2 (state.change.logger)
[2023-02-11 15:33:21,812] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-11 15:33:21,836] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:33:21,838] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 10 (state.change.logger)
[2023-02-11 15:33:21,839] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 10 (state.change.logger)
[2023-02-11 15:33:21,851] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:33:21,853] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 11 (state.change.logger)
[2023-02-11 15:33:21,853] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 11 (state.change.logger)
[2023-02-11 15:33:21,883] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 20 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-11 15:33:21,888] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:33:21,889] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 12 (state.change.logger)
[2023-02-11 15:33:21,890] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 12 (state.change.logger)
[2023-02-11 15:33:21,894] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,902] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,904] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,907] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 13 from offset 2 with partition epoch 13, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,910] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 15 with partition epoch 13, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,912] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,915] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,917] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,920] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,922] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,924] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,927] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 13 from offset 1 with partition epoch 13, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,930] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,933] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 1101 with partition epoch 13, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,936] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 5 with partition epoch 13, high watermark 5, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,939] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,941] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,944] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 13 from offset 139 with partition epoch 13, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,946] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,949] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,951] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,953] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,955] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,957] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,960] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 152 with partition epoch 13, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,962] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,964] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,967] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,969] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 7 with partition epoch 13, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,971] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,974] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,976] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,978] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,981] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,983] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 13 from offset 3 with partition epoch 13, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,986] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,988] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,990] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,992] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,994] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,997] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:21,999] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,001] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,003] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,005] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,007] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 200 with partition epoch 13, high watermark 200, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,009] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,011] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,014] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 45 with partition epoch 13, high watermark 45, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,016] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,018] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,020] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,023] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,025] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 13 from offset 0 with partition epoch 13, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:33:22,071] INFO [Broker id=0] Finished LeaderAndIsr request in 259ms correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-11 15:33:22,077] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 4 (state.change.logger)
[2023-02-11 15:33:22,099] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 5 (state.change.logger)
[2023-02-11 15:33:22,103] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 6 (state.change.logger)
[2023-02-11 15:33:22,105] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 7 (state.change.logger)
[2023-02-11 15:33:53,904] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:33:53,974] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,975] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,976] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,976] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,982] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,983] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,984] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,985] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,987] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,987] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,988] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,989] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,990] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,991] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,992] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,993] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,995] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,995] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,996] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:53,997] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,000] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,001] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,002] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,002] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,004] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,004] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,005] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,005] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,007] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,007] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,007] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,008] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,009] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,010] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,010] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,011] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,012] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,013] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,013] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,014] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,015] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,016] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,016] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,017] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,018] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,019] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,019] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,020] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,021] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,022] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,023] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,024] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,026] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,026] ERROR [Controller id=3 epoch=20] Controller 3 epoch 20 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:622)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:592)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1610)
	at kafka.controller.KafkaController.process(KafkaController.scala:2565)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-11 15:33:54,028] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:33:54,131] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,131] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,131] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition library-events-0 state changed to (Leader:3,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:25,ZkVersion:40,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,132] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,133] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,134] INFO [Controller id=3 epoch=20] Partition library-events-2 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:36,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition library-events-1 state changed to (Leader:1,ISR:1,3,LeaderRecoveryState:RECOVERED,LeaderEpoch:31,ZkVersion:46,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,135] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:33:54,136] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 15:33:54,137] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-11 15:33:54,137] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 57 partitions (state.change.logger)
[2023-02-11 15:33:54,138] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 13 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:33:54,138] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 13 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:33:54,139] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 3 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:33:54,139] INFO [Broker id=3] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 25 from offset 26 with partition epoch 40, high watermark 26, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 24. (state.change.logger)
[2023-02-11 15:33:54,142] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 3 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-11 15:33:54,142] INFO [Broker id=1] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 21 from offset 37 with partition epoch 36, high watermark 37, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 20. (state.change.logger)
[2023-02-11 15:33:54,143] INFO [Broker id=3] Follower library-events-2 starts at leader epoch 21 from offset 37 with partition epoch 36 and high watermark 37. Current leader is 1. Previous leader epoch was 20. (state.change.logger)
[2023-02-11 15:33:54,143] INFO [Broker id=3] Follower library-events-1 starts at leader epoch 31 from offset 30 with partition epoch 46 and high watermark 30. Current leader is 1. Previous leader epoch was 30. (state.change.logger)
[2023-02-11 15:33:54,144] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 13 for 2 partitions (state.change.logger)
[2023-02-11 15:33:54,145] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 31 from offset 30 with partition epoch 46, high watermark 30, ISR [1,3], adding replicas [] and removing replicas []. Previous leader epoch was 30. (state.change.logger)
[2023-02-11 15:33:54,145] INFO [Broker id=3] Finished LeaderAndIsr request in 7ms correlationId 13 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:33:54,148] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 14 (state.change.logger)
[2023-02-11 15:33:54,148] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 25 from offset 26 with partition epoch 40 and high watermark 26. Current leader is 3. Previous leader epoch was 24. (state.change.logger)
[2023-02-11 15:33:54,150] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 13 for 1 partitions (state.change.logger)
[2023-02-11 15:33:54,150] INFO [Broker id=1] Finished LeaderAndIsr request in 12ms correlationId 13 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:33:54,152] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 14 (state.change.logger)
[2023-02-11 15:34:06,046] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(1, 3) for 0 partitions (state.change.logger)
[2023-02-11 15:34:06,047] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-11 15:34:06,051] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 57 become-follower partitions (state.change.logger)
[2023-02-11 15:34:06,052] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 57 partitions (state.change.logger)
[2023-02-11 15:34:06,055] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 16 (state.change.logger)
[2023-02-11 15:34:06,056] INFO [Broker id=3] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 16 (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,107] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,108] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,109] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,109] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,109] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,109] INFO [Controller id=3 epoch=20] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=15) (state.change.logger)
[2023-02-11 15:34:06,109] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:34:06,109] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 54 partitions (state.change.logger)
[2023-02-11 15:34:06,111] INFO [Broker id=3] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 17 (state.change.logger)
[2023-02-11 15:34:06,111] INFO [Broker id=1] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 17 (state.change.logger)
[2023-02-11 15:34:06,383] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 0 (state.change.logger)
[2023-02-11 15:34:06,405] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-11 15:34:06,493] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-0 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,510] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-48 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,510] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-2 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,510] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-29 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,511] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-10 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,511] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-45 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,511] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-26 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,511] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-7 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,512] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-42 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,512] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-4 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,512] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-23 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,513] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-3 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,513] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-1 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,516] INFO [Broker id=0] Follower library-events-2 starts at leader epoch 21 from offset 37 with partition epoch 36 and high watermark 35. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,516] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-20 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,517] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-39 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,517] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-17 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,517] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-36 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,518] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-0 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,518] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-14 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,518] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-33 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,519] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-49 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,519] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-11 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,519] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-30 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,519] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-46 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,520] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-27 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,520] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 25 from offset 26 with partition epoch 40 and high watermark 25. Current leader is 3. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,520] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-8 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,521] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-24 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,521] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-43 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,521] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-5 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,522] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-21 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,522] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-2 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,522] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-40 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,523] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-37 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,524] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-18 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,524] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition test-topic-1 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,525] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-34 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,525] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-15 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,525] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-12 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,526] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-31 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,526] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-9 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,527] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-47 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,528] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-19 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,528] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-28 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,529] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 31 from offset 30 with partition epoch 46 and high watermark 29. Current leader is 1. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,529] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-38 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,529] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-35 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,530] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-6 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,530] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-44 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,530] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-25 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,530] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-16 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,531] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-22 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,531] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-41 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,531] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-32 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,531] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-3 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,532] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 20 for partition __consumer_offsets-13 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2023-02-11 15:34:06,538] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 1 for 3 partitions (state.change.logger)
[2023-02-11 15:34:06,634] INFO [Broker id=0] Finished LeaderAndIsr request in 226ms correlationId 1 from controller 3 for 57 partitions (state.change.logger)
[2023-02-11 15:34:06,649] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 2 (state.change.logger)
[2023-02-11 15:34:06,649] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:34:06,653] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-11 15:34:06,655] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 18 (state.change.logger)
[2023-02-11 15:34:06,655] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 18 (state.change.logger)
[2023-02-11 15:34:06,658] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:34:06,661] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 19 (state.change.logger)
[2023-02-11 15:34:06,663] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 19 (state.change.logger)
[2023-02-11 15:34:06,669] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:34:06,671] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 20 as part of the become-leader transition for 54 partitions (state.change.logger)
[2023-02-11 15:34:06,671] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 20 (state.change.logger)
[2023-02-11 15:34:06,672] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 20 (state.change.logger)
[2023-02-11 15:34:06,682] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,690] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,695] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,697] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 2 with partition epoch 15, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,700] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 15 with partition epoch 15, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,703] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,705] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,708] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,711] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,713] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,715] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,718] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 1 with partition epoch 15, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,721] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,724] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 1101 with partition epoch 15, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,726] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 5 with partition epoch 15, high watermark 5, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,728] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,730] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,733] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 139 with partition epoch 15, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,735] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,737] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,740] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,743] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,745] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,748] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,750] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 152 with partition epoch 15, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,752] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,754] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,757] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,760] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 7 with partition epoch 15, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,763] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,766] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,768] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,770] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,773] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,775] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 3 with partition epoch 15, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,778] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,780] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,782] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,785] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,787] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,789] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,791] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,793] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,795] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,797] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,800] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 200 with partition epoch 15, high watermark 200, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,802] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,804] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,808] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 45 with partition epoch 15, high watermark 45, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,810] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,812] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,814] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,816] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,818] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:34:06,844] INFO [Broker id=0] Finished LeaderAndIsr request in 190ms correlationId 3 from controller 3 for 54 partitions (state.change.logger)
[2023-02-11 15:34:06,847] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 4 (state.change.logger)
[2023-02-11 15:34:06,851] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 5 (state.change.logger)
[2023-02-11 15:34:06,853] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 6 (state.change.logger)
[2023-02-11 15:34:06,855] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 7 (state.change.logger)
[2023-02-11 15:35:01,941] INFO [Controller id=3 epoch=20] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=26, isr=List(1, 0), leaderRecoveryState=RECOVERED, partitionEpoch=42) (state.change.logger)
[2023-02-11 15:35:01,941] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:35:01,941] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 15:35:01,942] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2023-02-11 15:35:01,943] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,943] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 21 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,943] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 21 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,944] INFO [Broker id=3] Follower library-events-0 starts at leader epoch 26 from offset 30 with partition epoch 42 and high watermark 30. Current leader is 1. Previous leader epoch was 25. (state.change.logger)
[2023-02-11 15:35:01,946] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 21 from controller 3 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,946] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 21 for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,946] INFO [Broker id=1] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 26 from offset 30 with partition epoch 42, high watermark 30, ISR [1,0], adding replicas [] and removing replicas []. Previous leader epoch was 25. (state.change.logger)
[2023-02-11 15:35:01,947] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:35:01,951] INFO [Broker id=3] Finished LeaderAndIsr request in 8ms correlationId 21 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,954] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 22 (state.change.logger)
[2023-02-11 15:35:01,954] INFO [Controller id=3 epoch=20] Sending StopReplica request for 2 replicas to broker 3 (state.change.logger)
[2023-02-11 15:35:01,966] INFO [Broker id=3] Handling StopReplica request correlationId 23 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:35:01,979] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 23 epoch 20 for partition library-events-1 since its associated leader epoch 31 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:01,979] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 23 epoch 20 for partition library-events-2 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:01,979] INFO [Broker id=1] Finished LeaderAndIsr request in 36ms correlationId 21 from controller 3 for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,982] INFO [Controller id=3 epoch=20] Partition library-events-1 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:32,ZkVersion:48,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:01,983] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 22 (state.change.logger)
[2023-02-11 15:35:01,983] INFO [Controller id=3 epoch=20] Partition library-events-2 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:38,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:01,983] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:35:01,984] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2023-02-11 15:35:01,984] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-11 15:35:01,985] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 23 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:35:01,986] INFO [Controller id=3 epoch=20] Sending StopReplica request for 2 replicas to broker 3 (state.change.logger)
[2023-02-11 15:35:01,987] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 23 from controller 3 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2023-02-11 15:35:01,987] INFO [Broker id=1] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 22 from offset 39 with partition epoch 38, high watermark 39, ISR [1,0], adding replicas [] and removing replicas []. Previous leader epoch was 21. (state.change.logger)
[2023-02-11 15:35:01,994] INFO [Broker id=1] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 32 from offset 34 with partition epoch 48, high watermark 33, ISR [1,0], adding replicas [] and removing replicas []. Previous leader epoch was 31. (state.change.logger)
[2023-02-11 15:35:01,998] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:35:01,999] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 24 (state.change.logger)
[2023-02-11 15:35:02,001] INFO [Broker id=1] Finished LeaderAndIsr request in 16ms correlationId 23 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:35:02,002] INFO [Broker id=3] Handling StopReplica request correlationId 25 from controller 3 for 2 partitions (state.change.logger)
[2023-02-11 15:35:02,003] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 25 epoch 20 for partition library-events-1 since its associated leader epoch 31 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,003] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 25 epoch 20 for partition library-events-2 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,007] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 24 (state.change.logger)
[2023-02-11 15:35:02,011] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 26 (state.change.logger)
[2023-02-11 15:35:02,011] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 25 (state.change.logger)
[2023-02-11 15:35:02,032] INFO [Controller id=3 epoch=20] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=33, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=49) (state.change.logger)
[2023-02-11 15:35:02,033] INFO [Controller id=3 epoch=20] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=27, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=43) (state.change.logger)
[2023-02-11 15:35:02,033] INFO [Controller id=3 epoch=20] Changed partition library-events-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=23, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=39) (state.change.logger)
[2023-02-11 15:35:02,033] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,034] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,036] INFO [Controller id=3 epoch=20] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,037] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 26 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,037] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,037] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 23 from offset 39 with partition epoch 39 and high watermark 39. Current leader is 0. Previous leader epoch was 22. (state.change.logger)
[2023-02-11 15:35:02,038] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 27 from offset 30 with partition epoch 43 and high watermark 30. Current leader is 0. Previous leader epoch was 26. (state.change.logger)
[2023-02-11 15:35:02,038] INFO [Controller id=3 epoch=20] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:35:02,038] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 33 from offset 34 with partition epoch 49 and high watermark 33. Current leader is 0. Previous leader epoch was 32. (state.change.logger)
[2023-02-11 15:35:02,040] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 3 epoch 20 with correlation id 26 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,044] INFO [Broker id=1] Finished LeaderAndIsr request in 8ms correlationId 26 from controller 3 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,047] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 20 with correlation id 27 (state.change.logger)
[2023-02-11 15:35:02,362] INFO [Controller id=1 epoch=21] Sending UpdateMetadata request to brokers Set(0, 1) for 0 partitions (state.change.logger)
[2023-02-11 15:35:02,433] INFO [Controller id=1 epoch=21] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,438] INFO [Controller id=1 epoch=21] Sending LeaderAndIsr request to broker 0 with 57 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,438] INFO [Controller id=1 epoch=21] Sending UpdateMetadata request to brokers Set(0, 1) for 57 partitions (state.change.logger)
[2023-02-11 15:35:02,440] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,440] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 21 for partition library-events-1 since its associated leader epoch 33 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,440] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 21 for partition library-events-0 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,440] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 21 for partition library-events-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,440] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,444] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 21 with correlation id 2 (state.change.logger)
[2023-02-11 15:35:02,474] INFO [Controller id=1 epoch=21] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:02,476] INFO [Controller id=1 epoch=21] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:43,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:02,476] INFO [Controller id=1 epoch=21] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:02,479] INFO [Controller id=1 epoch=21] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,479] INFO [Controller id=1 epoch=21] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:35:02,480] INFO [Controller id=1 epoch=21] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,480] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,480] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 21 for partition library-events-1 since its associated leader epoch 33 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,480] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 21 for partition library-events-0 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,480] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 21 for partition library-events-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:02,481] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:35:02,483] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 21 with correlation id 4 (state.change.logger)
[2023-02-11 15:35:07,049] INFO [Controller id=1 epoch=21] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:35:07,053] INFO [Controller id=1 epoch=21] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2023-02-11 15:35:07,060] INFO [Broker id=1] Handling StopReplica request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:35:07,062] INFO [Controller id=1 epoch=21] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:21) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:07,064] INFO [Controller id=1 epoch=21] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:43,ControllerEpoch:21) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:07,064] INFO [Controller id=1 epoch=21] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:21) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:35:07,065] INFO [Controller id=1 epoch=21] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:35:07,066] INFO [Controller id=1 epoch=21] Sending UpdateMetadata request to brokers Set(0, 1) for 3 partitions (state.change.logger)
[2023-02-11 15:35:07,067] INFO [Controller id=1 epoch=21] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2023-02-11 15:35:07,069] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 5 epoch 21 for partition library-events-1 since its associated leader epoch 33 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:07,070] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 5 epoch 21 for partition library-events-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:07,070] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 5 epoch 21 for partition library-events-0 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:07,088] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 21 with correlation id 6 (state.change.logger)
[2023-02-11 15:35:07,089] INFO [Broker id=1] Handling StopReplica request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2023-02-11 15:35:07,089] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 21 for partition library-events-1 since its associated leader epoch 33 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:07,090] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 21 for partition library-events-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 15:35:07,090] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 21 for partition library-events-0 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:37:35,705] INFO [Controller id=0 epoch=22] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-11 15:37:35,793] INFO [Controller id=0 epoch=22] Sending LeaderAndIsr request to broker 0 with 57 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:37:35,800] INFO [Controller id=0 epoch=22] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-11 15:37:35,816] INFO [Controller id=0 epoch=22] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:22) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:37:35,817] INFO [Controller id=0 epoch=22] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:43,ControllerEpoch:22) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:37:35,818] INFO [Controller id=0 epoch=22] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:22) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:37:35,824] INFO [Controller id=0 epoch=22] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:37:35,825] INFO [Controller id=0 epoch=22] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:43,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:37:35,825] INFO [Controller id=0 epoch=22] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:37:35,825] INFO [Controller id=0 epoch=22] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:37:35,825] INFO [Controller id=0 epoch=22] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-11 15:37:35,857] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-11 15:37:35,908] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 22 as part of the become-leader transition for 57 partitions (state.change.logger)
[2023-02-11 15:37:35,926] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,932] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,937] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 2 with partition epoch 15, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,940] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,942] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 15 with partition epoch 15, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,945] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,947] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,950] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,953] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,956] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,958] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,960] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 1 with partition epoch 15, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,962] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,967] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 23 from offset 39 with partition epoch 39, high watermark 37, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,975] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 1101 with partition epoch 15, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,978] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 5 with partition epoch 15, high watermark 5, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,980] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,983] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,986] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 139 with partition epoch 15, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,989] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,991] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 1 with partition epoch 15, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,992] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,995] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:35,998] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,001] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,005] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 152 with partition epoch 15, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,008] INFO [Broker id=0] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 27 from offset 30 with partition epoch 43, high watermark 27, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,012] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,015] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,018] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,021] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 7 with partition epoch 15, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,024] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,029] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,032] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,036] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,040] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,043] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 3 with partition epoch 15, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,045] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,048] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,051] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,054] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,057] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,059] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,062] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,065] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,069] INFO [Broker id=0] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 33 from offset 33 with partition epoch 49, high watermark 30, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,073] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,076] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,078] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 200 with partition epoch 15, high watermark 200, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,081] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,084] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,088] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 45 with partition epoch 15, high watermark 45, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,091] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,094] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,097] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,100] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,104] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:37:36,145] INFO [Broker id=0] Finished LeaderAndIsr request in 290ms correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-11 15:37:36,184] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 22 with correlation id 2 (state.change.logger)
[2023-02-11 15:37:36,187] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:37:36,189] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 22 for partition library-events-1 since its associated leader epoch 33 matches the current leader epoch (state.change.logger)
[2023-02-11 15:37:36,189] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 22 for partition library-events-0 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:37:36,189] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 22 for partition library-events-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 15:37:36,190] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:37:36,192] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 22 with correlation id 4 (state.change.logger)
[2023-02-11 15:40:25,640] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-11 15:40:25,714] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 57 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:40:25,719] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers Set(0) for 57 partitions (state.change.logger)
[2023-02-11 15:40:25,744] INFO [Controller id=0 epoch=23] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:23) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:40:25,745] INFO [Controller id=0 epoch=23] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:43,ControllerEpoch:23) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:40:25,745] INFO [Controller id=0 epoch=23] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:23) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:40:25,750] INFO [Controller id=0 epoch=23] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:40:25,751] INFO [Controller id=0 epoch=23] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:43,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:40:25,751] INFO [Controller id=0 epoch=23] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-02-11 15:40:25,752] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:40:25,752] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers Set(0) for 3 partitions (state.change.logger)
[2023-02-11 15:40:25,791] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-11 15:40:25,856] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 23 as part of the become-leader transition for 57 partitions (state.change.logger)
[2023-02-11 15:40:25,875] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,891] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,893] INFO [Broker id=0] Leader test-topic-2 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 2 with partition epoch 15, high watermark 2, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,896] INFO [Broker id=0] Leader __consumer_offsets-29 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,899] INFO [Broker id=0] Leader __consumer_offsets-10 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 15 with partition epoch 15, high watermark 15, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,902] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,904] INFO [Broker id=0] Leader __consumer_offsets-26 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,907] INFO [Broker id=0] Leader __consumer_offsets-7 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,909] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,912] INFO [Broker id=0] Leader __consumer_offsets-4 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,915] INFO [Broker id=0] Leader __consumer_offsets-23 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,918] INFO [Broker id=0] Leader test-topic-3 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 1 with partition epoch 15, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,921] INFO [Broker id=0] Leader __consumer_offsets-1 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,925] INFO [Broker id=0] Leader library-events-2 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 23 from offset 39 with partition epoch 39, high watermark 39, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,931] INFO [Broker id=0] Leader __consumer_offsets-20 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 1101 with partition epoch 15, high watermark 1101, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,934] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 5 with partition epoch 15, high watermark 5, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,937] INFO [Broker id=0] Leader __consumer_offsets-17 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,939] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,942] INFO [Broker id=0] Leader test-topic-0 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 139 with partition epoch 15, high watermark 139, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,945] INFO [Broker id=0] Leader __consumer_offsets-14 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,949] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 1 with partition epoch 15, high watermark 1, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,950] INFO [Broker id=0] Leader __consumer_offsets-49 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,953] INFO [Broker id=0] Leader __consumer_offsets-11 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,956] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,959] INFO [Broker id=0] Leader __consumer_offsets-46 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,962] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 152 with partition epoch 15, high watermark 152, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,965] INFO [Broker id=0] Leader library-events-0 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 27 from offset 30 with partition epoch 43, high watermark 30, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,968] INFO [Broker id=0] Leader __consumer_offsets-8 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,971] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,974] INFO [Broker id=0] Leader __consumer_offsets-43 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,978] INFO [Broker id=0] Leader __consumer_offsets-5 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 7 with partition epoch 15, high watermark 7, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,981] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,984] INFO [Broker id=0] Leader __consumer_offsets-2 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,987] INFO [Broker id=0] Leader __consumer_offsets-40 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,990] INFO [Broker id=0] Leader __consumer_offsets-37 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,994] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:25,997] INFO [Broker id=0] Leader test-topic-1 with topic id Some(OANUbA1wTjKPD7l7SpgrSg) starts at leader epoch 15 from offset 3 with partition epoch 15, high watermark 3, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,000] INFO [Broker id=0] Leader __consumer_offsets-34 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,002] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,005] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,008] INFO [Broker id=0] Leader __consumer_offsets-31 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,012] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,014] INFO [Broker id=0] Leader __consumer_offsets-47 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,017] INFO [Broker id=0] Leader __consumer_offsets-19 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,020] INFO [Broker id=0] Leader __consumer_offsets-28 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,023] INFO [Broker id=0] Leader library-events-1 with topic id Some(NttruNBaTVeuPGOd36u1gw) starts at leader epoch 33 from offset 33 with partition epoch 49, high watermark 33, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,027] INFO [Broker id=0] Leader __consumer_offsets-38 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,030] INFO [Broker id=0] Leader __consumer_offsets-35 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,033] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 200 with partition epoch 15, high watermark 200, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,036] INFO [Broker id=0] Leader __consumer_offsets-44 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,040] INFO [Broker id=0] Leader __consumer_offsets-25 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,043] INFO [Broker id=0] Leader __consumer_offsets-16 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 45 with partition epoch 15, high watermark 45, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,046] INFO [Broker id=0] Leader __consumer_offsets-22 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,048] INFO [Broker id=0] Leader __consumer_offsets-41 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,052] INFO [Broker id=0] Leader __consumer_offsets-32 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,055] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,058] INFO [Broker id=0] Leader __consumer_offsets-13 with topic id Some(WX2zNAFfSXyDCUNjGn6kLA) starts at leader epoch 15 from offset 0 with partition epoch 15, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:40:26,145] INFO [Broker id=0] Finished LeaderAndIsr request in 353ms correlationId 1 from controller 0 for 57 partitions (state.change.logger)
[2023-02-11 15:40:26,158] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 2 (state.change.logger)
[2023-02-11 15:40:26,162] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:40:26,163] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 23 for partition library-events-1 since its associated leader epoch 33 matches the current leader epoch (state.change.logger)
[2023-02-11 15:40:26,163] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 23 for partition library-events-0 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2023-02-11 15:40:26,163] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 23 for partition library-events-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2023-02-11 15:40:26,164] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2023-02-11 15:40:26,177] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 4 (state.change.logger)
[2023-02-11 15:42:27,961] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-11 15:43:02,576] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2023-02-11 15:43:02,577] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(3) for 0 partitions (state.change.logger)
[2023-02-11 15:43:10,446] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 3) for 0 partitions (state.change.logger)
[2023-02-11 15:43:10,447] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(1) for 0 partitions (state.change.logger)
[2023-02-11 15:43:26,903] INFO [Controller id=0 epoch=1] Changed partition library-events-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:26,904] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:43:26,914] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:43:26,961] INFO [Controller id=0 epoch=1] Changed partition library-events-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:26,966] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:43:26,971] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 15:43:26,974] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:43:26,985] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 15:43:26,999] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 2 (state.change.logger)
[2023-02-11 15:43:27,000] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-22 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,000] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-30 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,001] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-8 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,001] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 3 (state.change.logger)
[2023-02-11 15:43:27,001] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-21 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,001] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-4 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,001] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-27 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,002] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-7 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,002] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-9 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,002] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-46 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,002] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-25 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,002] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-35 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,003] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-41 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,003] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-33 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,003] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-23 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,003] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-49 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,003] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-47 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-16 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-28 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-31 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-36 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-42 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-3 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-18 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-37 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,004] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-15 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-24 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-38 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-17 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-48 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-19 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-11 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-13 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-2 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-43 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-6 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-14 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,005] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-20 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-44 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-39 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-12 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-45 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-1 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-5 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-26 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-29 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-34 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-10 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,006] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-32 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2023-02-11 15:43:27,007] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-40 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:43:27,007] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:43:27,010] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:43:27,050] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-22 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-30 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-8 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-21 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-27 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-7 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-9 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-46 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-25 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-35 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-41 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,135] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-33 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-23 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-49 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-47 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-16 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-28 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-31 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-36 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-42 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-18 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,136] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-37 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-15 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-24 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-38 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-17 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-48 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-19 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,137] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-11 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-13 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-43 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-6 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-14 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-20 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,138] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-44 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-39 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-12 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-45 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-26 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,139] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-29 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,140] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-34 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,140] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-10 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,140] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-32 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,140] INFO [Controller id=0 epoch=1] Changed partition __consumer_offsets-40 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:43:27,141] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 1 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:43:27,142] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 3 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:43:27,143] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:43:27,144] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 50 partitions (state.change.logger)
[2023-02-11 15:43:27,149] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:43:27,151] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 17 partitions (state.change.logger)
[2023-02-11 15:43:27,152] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 17 partitions (state.change.logger)
[2023-02-11 15:43:27,228] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 1 as part of the become-leader transition for 17 partitions (state.change.logger)
[2023-02-11 15:43:27,281] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 1 as part of the become-leader transition for 17 partitions (state.change.logger)
[2023-02-11 15:43:27,363] INFO [Broker id=1] Leader library-events-0 with topic id Some(1L_Re62BSM-ES62PZ2GuYQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,449] INFO [Broker id=1] Finished LeaderAndIsr request in 469ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 15:43:27,466] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 2 (state.change.logger)
[2023-02-11 15:43:27,469] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 16 partitions (state.change.logger)
[2023-02-11 15:43:27,497] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 1 as part of the become-leader transition for 16 partitions (state.change.logger)
[2023-02-11 15:43:27,501] INFO [Broker id=0] Leader __consumer_offsets-0 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,543] INFO [Broker id=1] Leader __consumer_offsets-29 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,553] INFO [Broker id=3] Leader __consumer_offsets-10 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,577] INFO [Broker id=1] Leader __consumer_offsets-26 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,608] INFO [Broker id=1] Leader __consumer_offsets-23 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,617] INFO [Broker id=0] Leader __consumer_offsets-48 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,627] INFO [Broker id=1] Leader __consumer_offsets-20 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,639] INFO [Broker id=0] Leader __consumer_offsets-45 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,656] INFO [Broker id=1] Leader __consumer_offsets-17 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,672] INFO [Broker id=0] Leader __consumer_offsets-42 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,686] INFO [Broker id=3] Leader __consumer_offsets-7 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,688] INFO [Broker id=1] Leader __consumer_offsets-14 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,703] INFO [Broker id=0] Leader __consumer_offsets-39 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,715] INFO [Broker id=1] Leader __consumer_offsets-11 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,724] INFO [Broker id=3] Leader __consumer_offsets-4 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,742] INFO [Broker id=0] Leader __consumer_offsets-36 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,761] INFO [Broker id=1] Leader __consumer_offsets-8 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,763] INFO [Broker id=3] Leader __consumer_offsets-1 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,782] INFO [Broker id=0] Leader __consumer_offsets-33 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,807] INFO [Broker id=1] Leader __consumer_offsets-5 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,807] INFO [Broker id=3] Leader __consumer_offsets-49 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,818] INFO [Broker id=0] Leader __consumer_offsets-30 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,838] INFO [Broker id=1] Leader __consumer_offsets-2 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,840] INFO [Broker id=3] Leader __consumer_offsets-46 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,848] INFO [Broker id=0] Leader __consumer_offsets-27 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,876] INFO [Broker id=1] Leader __consumer_offsets-47 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,890] INFO [Broker id=3] Leader __consumer_offsets-43 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,900] INFO [Broker id=0] Leader __consumer_offsets-24 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,921] INFO [Broker id=1] Leader __consumer_offsets-38 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,931] INFO [Broker id=0] Leader __consumer_offsets-21 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,934] INFO [Broker id=3] Leader __consumer_offsets-40 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,951] INFO [Broker id=1] Leader __consumer_offsets-35 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,960] INFO [Broker id=0] Leader __consumer_offsets-18 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,960] INFO [Broker id=3] Leader __consumer_offsets-37 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,991] INFO [Broker id=1] Leader __consumer_offsets-44 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,994] INFO [Broker id=0] Leader __consumer_offsets-15 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:27,996] INFO [Broker id=3] Leader __consumer_offsets-34 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,038] INFO [Broker id=0] Leader __consumer_offsets-12 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,041] INFO [Broker id=3] Leader __consumer_offsets-31 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,041] INFO [Broker id=1] Leader __consumer_offsets-41 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,071] INFO [Broker id=0] Leader __consumer_offsets-9 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,074] INFO [Broker id=1] Leader __consumer_offsets-32 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,074] INFO [Broker id=3] Leader __consumer_offsets-19 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,107] INFO [Broker id=0] Leader __consumer_offsets-6 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,121] INFO [Broker id=3] Leader __consumer_offsets-28 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,126] INFO [Broker id=1] Finished LeaderAndIsr request in 657ms correlationId 3 from controller 0 for 16 partitions (state.change.logger)
[2023-02-11 15:43:28,139] INFO [Broker id=1] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 4 (state.change.logger)
[2023-02-11 15:43:28,143] INFO [Broker id=0] Leader __consumer_offsets-3 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,156] INFO [Broker id=3] Leader __consumer_offsets-25 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,190] INFO [Broker id=3] Leader __consumer_offsets-16 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,193] INFO [Broker id=0] Finished LeaderAndIsr request in 1043ms correlationId 4 from controller 0 for 17 partitions (state.change.logger)
[2023-02-11 15:43:28,209] INFO [Broker id=0] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 5 (state.change.logger)
[2023-02-11 15:43:28,226] INFO [Broker id=3] Leader __consumer_offsets-22 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,249] INFO [Broker id=3] Leader __consumer_offsets-13 with topic id Some(yUXPZl-lTo-r9p2nN5iOOQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:43:28,292] INFO [Broker id=3] Finished LeaderAndIsr request in 1143ms correlationId 3 from controller 0 for 17 partitions (state.change.logger)
[2023-02-11 15:43:28,306] INFO [Broker id=3] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 4 (state.change.logger)
[2023-02-11 15:44:02,727] INFO [Controller id=0 epoch=1] Changed partition library-events-2 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 15:44:02,727] INFO [Controller id=0 epoch=1] Changed partition library-events-1 state from NonExistentPartition to NewPartition with assigned replicas 3 (state.change.logger)
[2023-02-11 15:44:02,727] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:44:02,728] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:44:02,746] INFO [Controller id=0 epoch=1] Changed partition library-events-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:44:02,747] INFO [Controller id=0 epoch=1] Changed partition library-events-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 15:44:02,747] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:44:02,747] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 15:44:02,747] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 2 partitions (state.change.logger)
[2023-02-11 15:44:02,749] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 15:44:02,749] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 15:44:02,749] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 15:44:02,751] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 5 (state.change.logger)
[2023-02-11 15:44:02,752] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:44:02,753] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 6 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 15:44:02,781] INFO [Broker id=0] Leader library-events-2 with topic id Some(1L_Re62BSM-ES62PZ2GuYQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:44:02,783] INFO [Broker id=3] Leader library-events-1 with topic id Some(1L_Re62BSM-ES62PZ2GuYQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 15:44:02,786] INFO [Broker id=0] Finished LeaderAndIsr request in 37ms correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 15:44:02,788] INFO [Broker id=3] Finished LeaderAndIsr request in 40ms correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 15:44:02,789] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 7 (state.change.logger)
[2023-02-11 15:44:02,791] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 6 (state.change.logger)
[2023-02-11 20:53:18,994] INFO [Controller id=0 epoch=1] Changed partition library-events.RETRY-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-11 20:53:19,002] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 20:53:19,002] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 20:53:19,018] INFO [Controller id=0 epoch=1] Changed partition library-events.RETRY-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-11 20:53:19,018] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-11 20:53:19,018] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-11 20:53:19,018] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-11 20:53:19,042] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 8 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 20:53:19,042] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 7 (state.change.logger)
[2023-02-11 20:53:19,042] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 8 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-11 20:53:19,042] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 6 (state.change.logger)
[2023-02-11 20:53:19,090] INFO [Broker id=0] Leader library-events.RETRY-0 with topic id Some(qJJklggwQmSxSu6UKKIL3A) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-11 20:53:19,090] INFO [Broker id=0] Finished LeaderAndIsr request in 48ms correlationId 8 from controller 0 for 1 partitions (state.change.logger)
[2023-02-11 20:53:19,098] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2023-02-12 02:46:26,212] INFO [Controller id=0 epoch=1] Changed partition library-events.DLT-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2023-02-12 02:46:26,213] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-12 02:46:26,213] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-12 02:46:26,222] INFO [Controller id=0 epoch=1] Changed partition library-events.DLT-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2023-02-12 02:46:26,222] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-02-12 02:46:26,222] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 3) for 1 partitions (state.change.logger)
[2023-02-12 02:46:26,223] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-02-12 02:46:26,228] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 10 from controller 0 for 1 partitions (state.change.logger)
[2023-02-12 02:46:26,228] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 8 (state.change.logger)
[2023-02-12 02:46:26,231] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 10 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2023-02-12 02:46:26,229] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 7 (state.change.logger)
[2023-02-12 02:46:26,256] INFO [Broker id=0] Leader library-events.DLT-0 with topic id Some(P20nQWOUSPO3x9kHgu30Rw) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [0], adding replicas [] and removing replicas []. Previous leader epoch was -1. (state.change.logger)
[2023-02-12 02:46:26,259] INFO [Broker id=0] Finished LeaderAndIsr request in 31ms correlationId 10 from controller 0 for 1 partitions (state.change.logger)
[2023-02-12 02:46:26,261] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 11 (state.change.logger)
